/*!
* powerpod 0.6.0
* https://github.com/mihailistov/powerpod
*
* @license GPLv3 for open source use only
*
* Copyright (C) 2024 http://github.com/mihailistov/powerpod - A project by Mihai Listov
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).powerpod=t()}(this,(function(){"use strict";function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _regeneratorRuntime(){_regeneratorRuntime=function(){return t};var e,t={},n=Object.prototype,a=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",c=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag";function define(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function(e,t,n){return e[t]=n}}function wrap(e,t,n,a){var r=t&&t.prototype instanceof Generator?t:Generator,o=Object.create(r.prototype),c=new Context(a||[]);return i(o,"_invoke",{value:makeInvokeMethod(e,n,c)}),o}function tryCatch(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=wrap;var s="suspendedStart",d="suspendedYield",u="executing",p="completed",h={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var g={};define(g,o,(function(){return this}));var m=Object.getPrototypeOf,f=m&&m(m(values([])));f&&f!==n&&a.call(f,o)&&(g=f);var v=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(g);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(n,i,r,o){var c=tryCatch(e[n],e,i);if("throw"!==c.type){var l=c.arg,s=l.value;return s&&"object"==typeof s&&a.call(s,"__await")?t.resolve(s.__await).then((function(e){invoke("next",e,r,o)}),(function(e){invoke("throw",e,r,o)})):t.resolve(s).then((function(e){l.value=e,r(l)}),(function(e){return invoke("throw",e,r,o)}))}o(c.arg)}var n;i(this,"_invoke",{value:function(e,a){function callInvokeWithMethodAndArg(){return new t((function(t,n){invoke(e,a,t,n)}))}return n=n?n.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(t,n,a){var i=s;return function(r,o){if(i===u)throw new Error("Generator is already running");if(i===p){if("throw"===r)throw o;return{value:e,done:!0}}for(a.method=r,a.arg=o;;){var c=a.delegate;if(c){var l=maybeInvokeDelegate(c,a);if(l){if(l===h)continue;return l}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(i===s)throw i=p,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);i=u;var g=tryCatch(t,n,a);if("normal"===g.type){if(i=a.done?p:d,g.arg===h)continue;return{value:g.arg,done:a.done}}"throw"===g.type&&(i=p,a.method="throw",a.arg=g.arg)}}}function maybeInvokeDelegate(t,n){var a=n.method,i=t.iterator[a];if(i===e)return n.delegate=null,"throw"===a&&t.iterator.return&&(n.method="return",n.arg=e,maybeInvokeDelegate(t,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+a+"' method")),h;var r=tryCatch(i,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,h;var o=r.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,h):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,r=function next(){for(;++i<t.length;)if(a.call(t,i))return next.value=t[i],next.done=!1,next;return next.value=e,next.done=!0,next};return r.next=r}}throw new TypeError(typeof t+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,i(v,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),i(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,l,"GeneratorFunction")),e.prototype=Object.create(v),e},t.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),t.AsyncIterator=AsyncIterator,t.async=function(e,n,a,i,r){void 0===r&&(r=Promise);var o=new AsyncIterator(wrap(e,n,a,i),r);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},defineIteratorMethods(v),define(v,l,"Generator"),define(v,o,(function(){return this})),define(v,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var a in t)n.push(a);return n.reverse(),function next(){for(;n.length;){var e=n.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},t.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(resetTryEntry),!t)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function handle(a,i){return o.type="throw",o.arg=t,n.next=a,i&&(n.method="next",n.arg=e),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],o=r.completion;if("root"===r.tryLoc)return handle("end");if(r.tryLoc<=this.prev){var c=a.call(r,"catchLoc"),l=a.call(r,"finallyLoc");if(c&&l){if(this.prev<r.catchLoc)return handle(r.catchLoc,!0);if(this.prev<r.finallyLoc)return handle(r.finallyLoc)}else if(c){if(this.prev<r.catchLoc)return handle(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return handle(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=e,o.arg=t,r?(this.method="next",this.next=r.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),resetTryEntry(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var i=a.arg;resetTryEntry(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,a){return this.delegate={iterator:values(t),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=e),h}},t}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function asyncGeneratorStep(e,t,n,a,i,r,o){try{var c=e[r](o),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(a,i)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function _next(e){asyncGeneratorStep(r,a,i,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(r,a,i,_next,_throw,"throw",e)}_next(void 0)}))}}function _defineProperty(e,t,n){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},_extends.apply(this,arguments)}function _objectDestructuringEmpty(e){if(null==e)throw new TypeError("Cannot destructure "+e)}function _objectWithoutProperties(e,t){if(null==e)return{};var n,a,i=function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_unsupportedIterableToArray(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var e=window,t=document,n={DEV:"dev",TEST:"test",PROD:"prod"},a=_defineProperty(_defineProperty(_defineProperty({},n.DEV,"af-pods-dev.powerappsportals.com"),n.TEST,"af-pods-test.powerappsportals.com"),n.PROD,"af-pods.powerappsportals.com"),i=["/claim/","/claim-dev/"],r=["/application/","/application-dev/"],o={Application:"Application",Claim:"Claim"},c={Input:"Input",FileInput:"FileInput",SingleOptionSet:"SingleOptionSet",MultiOptionSet:"MultiOptionSet",DropdownSelect:"DropdownSelect",DatePicker:"DatePicker"},l={Documents:"DocumentsStep",DeclarationAndConsent:"DeclarationAndConsentStep",ApplicantInfo:"ApplicantInfoStep",Eligibility:"EligibilityStep",Project:"ProjectStep",DeliverablesBudget:"DeliverablesBudgetStep",DemographicInfo:"DemographicInfoStep",ClaimInfo:"ClaimInfoStep",ProjectIndicators:"ProjectIndicatorsStep",Consent:"ConsentStep",Unknown:"UnknownStep"},s=_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},l.Documents,"Documents"),l.DeclarationAndConsent,"Application Declaration and Consent"),l.ApplicantInfo,"Applicant Information"),l.Eligibility,"Eligibility"),l.Project,"Project"),l.DeliverablesBudget,"Deliverables & Budget"),l.DemographicInfo,"Demographic Information"),l.ClaimInfo,"Claim Information"),l.ProjectIndicators,"Project Results"),d="255550000",u="255550001",p="255550010",h="255550001",g="6ce2584f-4740-ee11-be6e-000d3af3ac95",m={test:{},shared:{}};function validateDemographicInfoRequiredFields(){var e=validateStepFields("DemographicInfoStep",!0),t=function validateDemographicPercentages(){var e=0,t=0,n=0,a=document.querySelector("#quartech_firstnationssharepercentage"),i=$(a).val(),r=parseFloat(i);e+=!!r&&r;var o=document.querySelector("#quartech_inukinuitsharepercentage"),c=$(o).val(),l=parseFloat(c);e+=!!l&&l;var s=document.querySelector("#quartech_mtissharepercentage"),d=$(s).val(),u=parseFloat(d);e+=!!u&&u;var p=document.querySelector("#quartech_indigenoussharepercentage"),h=$(p).val(),g=parseFloat(h);e+=!!g&&g;var m=document.querySelector("#quartech_womensharepercentage"),f=$(m).val(),v=parseFloat(f);t+=!!v&&v;var y=document.querySelector("#quartech_youth40orundersharepercentage"),b=$(y).val(),_=parseFloat(b);n+=!!_&&_;var q=document.querySelector("#quartech_nonindiginousnonwomennonyouthshare"),S=$(q).val(),w=parseFloat(S);e+=!!w&&w,t+=!!w&&w,n+=!!w&&w;var F=document.querySelector("#quartech_unabletoansweridentifysharepercentage"),O=$(F).val(),C=parseFloat(O);t+=!!C&&C,n+=!!C&&C;var T="",P="Please check your answers. The total of shares held by",A="should NOT add up to more than 100%";return(e+=!!C&&C)>100&&(T+="<div><span>".concat(P,' Indigenous owners + Not-Indigenous/Not-Women/Not-Youth + Unable to answer<span style="color:red;"> ').concat(A,"</span></div>")),t>100&&(T+="<div><span>".concat(P,' Women owners + Not-Indigenous/Not-Women/Not-Youth + Unable to answer<span style="color:red;"> ').concat(A,"</span></div>")),n>100&&(T+="<div><span>".concat(P,' Youth owners + Not-Indigenous/Not-Women/Not-Youth owners + Unable to answer<span style="color:red;"> ').concat(A,"</span></div>")),T}();displayValidationErrors(e=e.concat(t))}var f="info",v="warn",y="error";function log(t){var n=t.namespace,a=t.fn,i=t.level,r=t.message,o=t.data,c=getOptions().logging;e.console&&e.console[i]||e.console.error("[POWERPOD]: issue using logger");var l=e.console[i],s="";s+=n?" (".concat(n,")"):"",s+=a&&"function"==typeof a&&a.name?" ".concat(a.name):"",c&&(l("[POWERPOD]"+s+": "+r),o&&"object"===_typeof(o)&&l(o))}function Logger(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{info:function info(t){var n=t.fn,a=void 0===n?null:n,i=t.message,r=t.data;return log({namespace:e,fn:a,level:f,message:i,data:void 0===r?null:r})},error:function error(t){var n=t.fn,a=void 0===n?null:n,i=t.message,r=t.data;return log({namespace:e,fn:a,level:y,message:i,data:void 0===r?null:r})},warn:function warn(t){var n=t.fn,a=void 0===n?null:n,i=t.message,r=t.data;return log({namespace:e,fn:a,level:v,message:i,data:void 0===r?null:r})}}}_defineProperty(_defineProperty(_defineProperty({},f,10),v,20),y,90);var b=Logger("common/config");function getGlobalConfigData(){var e,t=localStorage.getItem("programData"),n=null===(e=JSON.parse(t))||void 0===e||null===(e=e.quartech_ApplicantPortalConfig)||void 0===e?void 0:e.quartech_configdata,a=JSON.parse(n);return b.info({fn:getApplicationConfigData,message:"successfully fetched global config data from storage",data:a}),a}function getClaimConfigData(){var e,t=localStorage.getItem("programData"),n=null===(e=JSON.parse(t))||void 0===e?void 0:e.quartech_applicantportalclaimformjson,a=JSON.parse(n);return b.info({fn:getApplicationConfigData,message:"successfully fetched claim config data from storage",data:a}),a}function getApplicationConfigData(e){var t,n=localStorage.getItem("programData"),a=null===(t=JSON.parse(n))||void 0===t?void 0:t.quartech_applicantportalapplicationformconfigjson,i=JSON.parse(a);return b.info({fn:getApplicationConfigData,message:"successfully fetched application config data from storage",data:i}),i}m.config={getGlobalConfigData:getGlobalConfigData,getClaimConfigData:getClaimConfigData,getApplicationConfigData:getApplicationConfigData};const _=new Logger("common/program");function getProgramId(){var e=$("#quartech_program").val(),n=new URLSearchParams(t.location.search).get("programid");if(!n)return e;if(e&&n&&e!=n){let a=t.location.href.replace(n,e);return location.replace(a),e}return n}function getProgramAbbreviation(){var e;const t=localStorage.getItem("programData");return null===(e=JSON.parse(t))||void 0===e?void 0:e.quartech_programabbreviation}function getCurrentStep(){var e;let t=l.Unknown;const n=function htmlDecode(e){var t;return null===(t=(new DOMParser).parseFromString(e,"text/html").documentElement.textContent)||void 0===t?void 0:t.replace(/[^\x00-\x7F]/g,"")}($("div > ol > li.list-group-item.active").html());return n&&0!==n.length?(t=null!==(e=Object.keys(s).find((e=>s[e]===n)))&&void 0!==e?e:t,_.info({fn:getCurrentStep,message:`Validating current step ${t}`,data:{activeTabName:n,TabNames:s}}),t&&t!==l.Unknown&&Object.values(l).includes(t)?(_.info({fn:getCurrentStep,message:`Successfully found current step ${t}`}),t):(t&&t!==l.Unknown||_.error({fn:getCurrentStep,message:"Unable to determine current step",data:{activeStep:t,activeTabName:n,TabNames:s,FormStep:l}}),l.Unknown)):(_.error({fn:getCurrentStep,message:"Failed to get activeTabName",data:{activeTabName:n}}),t)}m.program={getProgramId:getProgramId,getProgramAbbreviation:getProgramAbbreviation,getCurrentStep:getCurrentStep},m.fields={getFieldsBySection:getFieldsBySection,getFieldsBySectionOld:function getFieldsBySectionOld(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=getProgramAbbreviation(),i=function generateFilterCondition(e){return"ALL"===e.name||e.name===a};if(a.includes("KTTP")&&(i=function generateFilterCondition(e){return"ALL"===e.name||"KTTP"===e.name||e.name===a}),!n){var r=localStorage.getItem("fieldsData-".concat(a,"-").concat(e));if(r)return JSON.parse(r)}var o=null===(t=getGlobalConfigData())||void 0===t?void 0:t.FieldsConfig;if(q.info({fn:getFieldsBySectionOld,message:"fieldsConfigData:",data:o}),o&&o.programs){var c=[];return null==o||o.programs.filter((function(e){return i(e)})).forEach((function(t){var n;if(t.sections){var a=null==t||null===(n=t.sections)||void 0===n?void 0:n.find((function(t){return(null==t?void 0:t.name)===e}));a&&a.fields&&a.fields.forEach((function(e){if(c&&c.length){var t=c.findIndex((function(t){return t.name===e.name}));t>-1&&c.splice(t,1)}c.push(e)}))}})),localStorage.setItem("fieldsData-".concat(a,"-").concat(e),JSON.stringify(c)),q.info({fn:getFieldsBySectionOld,message:"fieldsData:",data:c}),c}},getFieldsBySectionNew:getFieldsBySectionNew};var q=Logger("common/fields");function getFieldsBySectionNew(e){var t,n,a,i,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=getProgramAbbreviation();if(!r){var c=localStorage.getItem("fieldsData-".concat(o,"-").concat(e));if(c)return JSON.parse(c)}var l=function getGlobalFieldsConfig(){var e;return q.info({data:getGlobalConfigData()}),null===(e=getGlobalConfigData())||void 0===e||null===(e=e.FieldsConfig)||void 0===e||null===(e=e.programs)||void 0===e?void 0:e.find((function(e){return"ALL"===e.name}))}();q.info({fn:getFieldsBySectionNew,message:"globalConfigData:",data:l});var s=getApplicationConfigData();q.info({fn:getFieldsBySectionNew,message:"applicationConfigData:",data:s});var d=null==l?void 0:l.sections,u=null==s?void 0:s.sections,p=null==u?void 0:u.find((function(t){return t.name===e})),h=d.find((function(t){return t.name===e})),g=[];if(p||h)return p&&null!==(t=p.fields)&&void 0!==t&&t.length?null!==(n=p.fields)&&void 0!==n&&n.length&&g.push(p.fields):q.warn({fn:getFieldsBySectionNew,message:"no applicationSection section found by sectionName: ".concat(e),data:{sectionName:e,forceRefresh:r,globalSections:d,applicationSections:u}}),h&&null!==(a=h.fields)&&void 0!==a&&a.length?null!==(i=h.fields)&&void 0!==i&&i.length&&(g=function mergeFieldArrays(e,t,n){for(var a={},i=0,r=[].concat(_toConsumableArray(t),_toConsumableArray(e));i<r.length;i++){var o=r[i],c=o[n];a[c]=_objectSpread2(c in a?_objectSpread2({},a[c]):{},o)}return n?Object.values(a):a}(h.fields,g,"name")):q.warn({fn:getFieldsBySectionNew,message:"no globalSection section found by sectionName: ".concat(e),data:{sectionName:e,forceRefresh:r,globalSections:d,applicationSections:u}}),g.forEach((function(e){q.info({fn:getFieldsBySectionNew,message:"showing field name: ".concat(e.name)}),showFieldRow(e.name)})),localStorage.setItem("fieldsData-".concat(o,"-").concat(e),JSON.stringify(g)),q.info({fn:getFieldsBySectionNew,message:"fieldsData:",data:g}),g;q.error({fn:getFieldsBySectionNew,message:"no configuration section found by sectionName: ".concat(e),data:{sectionName:e,forceRefresh:r,globalSections:d,applicationSections:u}})}function getFieldsBySection(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=getProgramAbbreviation();if(!n){var i=localStorage.getItem("fieldsData-".concat(a,"-").concat(e));if(i)return JSON.parse(i)}var r=null===(t=getClaimConfigData())||void 0===t?void 0:t.FieldsConfig;if(q.info({fn:getFieldsBySection,message:"fieldsConfigData:",data:r}),r&&r.programs){var o=[];return null==r||r.programs.filter((function(e){return e.name===a})).forEach((function(t){var n;if(t.sections){var a=null==t||null===(n=t.sections)||void 0===n?void 0:n.find((function(t){return(null==t?void 0:t.name)===e}));a&&a.fieldsets&&a.fieldsets.forEach((function(e){if(e.name&&e.fields){var t=e.name,n=e.fields;!function showFieldsetElement(e){var t=$('fieldset[aria-label="'.concat(e,'"]'));t&&t.css({display:""})}(t),n.forEach((function(e){showFieldRow(e.name),o.push(e)}))}}))}})),localStorage.setItem("fieldsData-".concat(a,"-").concat(e),JSON.stringify(o)),q.info({fn:getFieldsBySection,message:"fieldsData:",data:o}),o}}var S=Logger("common/validation");function validateRequiredFields(){var e=getCurrentStep();e!==l.DemographicInfo?validateStepFields(e):validateDemographicInfoRequiredFields()}function validateStepFields(e,t){e||(e=getCurrentStep());var n,a="";if(!(n=getOptions().form===o.Application?getFieldsBySectionNew(e):getFieldsBySection(e)))return"";for(var i=function _loop(){var e=n[r],t=e.name,i=e.required,o=e.elementType,c=e.validation;if(i){var l;l=o?validateRequiredField(t,o):validateRequiredField(t),a=a.concat(l)}if("numeric"===(null==c?void 0:c.type)){var s=c.value,d=c.comparison,u=function validateNumericFieldValue(e,t,n,a){var i=document.querySelector("#".concat(e));if(i){if(""===i.value&&!a)return"";var r=parseFloat(i.value.replace(/,/g,"").replace("$","")),o=$("#".concat(e,"_label")).text(),c='<div><span>"'.concat(o,'"</span><span style="color:red;"> Please enter a valid number');switch(n){case"greaterThan":return r>t&&""!==r?"":"".concat(c,". The value must be greater than ").concat(t,".</span></div>");case"lessThan":return r<t&&""!==r?"":"".concat(c,". The value must be less than ").concat(t,".</span></div>");case"equalTo":return r!==t||""===r?"".concat(c,". The value must be equal to ").concat(t,".</span></div>"):"";case"greaterThanOrEqualTo":return r>=t&&""!==r?"":"".concat(c,". The value must be greater than or equal to ").concat(t,".</span></div>");case"lessThanOrEqualTo":return r<=t&&""!==r?"":"".concat(c,". The value must be less than or equal to ").concat(t,".</span></div>");default:return"Invalid operator"}}}(t,s,d);a=a.concat(u)}if("length"===(null==c?void 0:c.type)){var p=c.value,h=c.comparison,g=c.forceRequired,m=c.postfix,f=c.overrideDisplayValue,v=function validateFieldLength(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;if(!$("#".concat(e,"_label")).is(":visible"))return"";var o=document.querySelector("#".concat(e));if(o){if(""===o.value&&!a)return"";var c=o.value.length,l='<span style="color:red;"> Please enter a valid length';switch(n){case"greaterThan":return c>t&&""!==c?"":"".concat(l,". The length must be greater than ").concat(null!=r?r:t).concat(i?" ".concat(i):"",".</span>");case"lessThan":return c<t&&""!==c?"":"".concat(l,". The length must be less than ").concat(null!=r?r:t).concat(i?" ".concat(i):"",".</span>");case"equalTo":return c!==t||""===c?"".concat(l,". The length must be equal to ").concat(null!=r?r:t).concat(i?" ".concat(i):"",".</span>"):"";case"greaterThanOrEqualTo":return c>=t&&""!==c?"":"".concat(l,". The length must be greater than or equal to ").concat(null!=r?r:t).concat(i?" ".concat(i):"",".</span>");case"lessThanOrEqualTo":return c<=t&&""!==c?"":"".concat(l,". The length must be less than or equal to ").concat(null!=r?r:t).concat(i?" ".concat(i):"",".</span>");default:return"Invalid operator"}}}(t,p,h,g,m,f);if(v&&v.length>0){$("#".concat(t,"_error_message")).html(v),$("#".concat(t)).on("focusout",(function(){$("#".concat(t,"_error_message")).css({display:""}),$("#".concat(t)).css({border:"1px solid #e5636c"})}));var y=$("#".concat(t,"_label")).text(),b='<span>"'.concat(y,'"</span>');a=a.concat("<div>".concat(b).concat(v,"</div>"))}else $("#".concat(t)).off("focusout"),$("#".concat(t,"_error_message")).css({display:"none"}),$("#".concat(t)).css({border:""})}},r=0;r<n.length;r++)i();if(Object.keys(localStorage).filter((function(e){return e.startsWith("shouldRequire_")})).forEach((function(e){var t=e.replace("shouldRequire_",""),i=n.find((function(e){return e.name===t}));if(!i||!i.required){var r;r=i&&i.elementType?validateRequiredField(t,i.elementType):validateRequiredField(t),a=a.concat(r)}})),t)return a;if("ProjectStep"===e){var c=getProgramAbbreviation();if(c&&"NEFBA"===c){var l=function validateIsConsultantEitherBciaOrCpa(){var e=document.querySelector("#quartech_bciaregisteredconsultant"),t=document.querySelector("#quartech_cpaconsultant"),n=document.querySelector("#quartech_completingcategory");return e&&n&&t?"255550000"===n.value||""===n.value?"":"255550002"===e.value&&"255550002"===t.value?'<div><span>You must select YES to either "Is the consultant registered with the BC Institute of Agrologists (BCIA)?" OR "If the consultant is NOT registered with the BC Institute of Agrologists (BCIA), is the consultant a Chartered Professional Accountant (CPA)?"</span><span style="color:red;"> The consultant must be registered with BCIA or CPA.</span></div>':"":""}();a=a.concat(l)}}displayValidationErrors(a)}function validateRequiredField(e){var t,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.Input,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"IS REQUIRED";if(!$("#".concat(e,"_label")).is(":visible"))return"";var r="",o=!0;switch(a){case c.FileInput:o=0===(null===(t=$("#".concat(e,"_AttachFile")))||void 0===t?void 0:t.val().length)&&0===(null===(n=$("#".concat(e)))||void 0===n?void 0:n.val().length);break;case c.MultiOptionSet:o=0==$("li[id*='".concat(e,"-selected-item-']")).length;break;case c.DropdownSelect:o=0==document.querySelector("#".concat(e)).value.length;break;case c.SingleOptionSet:case c.DatePicker:default:o=""==$("#".concat(e)).val()}if(o){var l=$("#".concat(e,"_label")).text();r='<div><span>"'.concat(l,'"</span><span style="color:red;"> ').concat(i,"</span></div>")}return r}function validateEmailAddressField(e){var t=document.querySelector("#".concat(e)),n=document.querySelector("#".concat(e,"_error_message"));if(t){if(!n){var a=document.createElement("div");if(a.id="".concat(e,"_error_message"),a.className="error_message",a.style="display:none;",$("#".concat(e)).parent().append(a),!(n=document.querySelector("#".concat(e,"_error_message"))))return}var i=/^\b[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b$/i;$(t).on("keyup keydown",(function(){var e=t.value;e&&i.test(e)?($(t).css({border:""}),$(n).css({display:"none"})):($(t).css({border:"1px solid #e5636c"}),$(n).html("<span>Email: must be a valid email.</span>"),$(n).css({display:""}))}))}}function displayValidationErrors(e){var t=$("#error_messages_div");if(S.info({fn:displayValidationErrors,message:"displaying validation errors"}),0==t.length){(t=document.createElement("div")).id="error_messages_div";var n=$("#NextButton").parent().parent();n.prepend(t),n.attr("id","actions_div")}else t=t[0];""==e?(t.innerHTML="",t.style="display:none;",$("#NextButton").prop("disabled",!1)):(t.innerHTML=e+"</br>",t.style="display:block;",$("#NextButton").prop("disabled",!0))}function addValidationCheck(e,t){var n;null!=t&&t.intervalBased?setInterval((function(){return validateStepFields()}),100):$("input[id*='".concat(e,"']")).on(null!==(n=null==t?void 0:t.event)&&void 0!==n?n:"onchange",(function(){validateStepFields()}))}function setInputMaxLength(e,t){$("#".concat(e)).attr("maxlength",t)}function setFieldReadOnly(e){$("#".concat(e)).attr("readonly",!0),$("#".concat(e)).on("mousedown",(function(e){e.preventDefault(),this.blur(),window.focus()})),$("#".concat(e)).attr("style","background-color: #eee !important")}function showFieldRow(e){var t,n,a=document.querySelector("#".concat(e,"_label"));if(a){var i=a.closest("tr");if(i){null===(t=$(i))||void 0===t||t.css({display:""});var r=i.closest("fieldset");null===(n=$(r))||void 0===n||n.css({display:""})}}}function addTextAboveField(e,t){var n=$("#".concat(e,"_label")).parent();n&&n.prepend(t)}function addTextBelowField(e,t){var n=$("#".concat(e,"_label")).parent().parent();n&&n.append(t)}function observeChanges(e,t){t?t():validateRequiredFields(),new MutationObserver((function(e,n){t?t():validateRequiredFields()})).observe(e,{attributes:!0,childList:!0,characterData:!0})}function observeIframeChanges(e,t,n){var a=document.querySelector('fieldset[aria-label="Coding Section (DO NOT REMOVE)"] iframe');null!=a&&a.nodeType&&observeChanges($(a)[0],(function(){e(t);var a=document.querySelector('fieldset[aria-label="Coding Section (DO NOT REMOVE)"] iframe'),i=null!=a&&a.contentDocument?null==a?void 0:a.contentDocument:null==a?void 0:a.contentWindow.document;null!=i&&i.nodeType&&observeChanges(i,(function(){var a=document.querySelector('fieldset[aria-label="Coding Section (DO NOT REMOVE)"] iframe'),i=a.contentDocument?a.contentDocument:a.contentWindow.document;e(t);var r=null==i?void 0:i.getElementById(n);null!=r&&r.nodeType&&observeChanges(r,(function(){e(t)}))}))}))}function hideFieldByFieldName(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=document.querySelector("#".concat(e,"_label"));if(a){var i=a.closest("tr"),r=document.querySelector("#".concat(e));i&&r&&($(i).css({display:"none"}),$("#".concat(e,"_label")).parent().removeClass("required"),localStorage.removeItem("shouldRequire_".concat(e)),t&&t(),$(r).off("change"),n||$(r).val(""))}}function hideQuestion(e){$("#".concat(e)).css("display","none"),$("#".concat(e)).val("");var t=document.querySelector("#".concat(e,"_label")).closest("tr");$(t).css({display:"none"}),validateRequiredFields()}function showOrHideAndReturnValue(e,t){var n=$("#".concat(e)),a=$("#".concat(t)),i=parseFloat(n.val().replace(/,/g,""));return isNaN(i)&&(i=0),0==i?(a.val(""),a.closest("td").css("display","none"),n.closest("td").attr("colspan","2")):(a.closest("td").css("display","block"),a.closest("td").attr("colspan","1"),n.closest("td").attr("colspan","1")),i}function setFieldValue(e,t){var n=document.querySelector("#".concat(e));if(n){n.value=t;var a=new Event("change");n.dispatchEvent(a)}}function combineElementsIntoOneRow(e,t){var n=$("#".concat(t)).closest("td"),a=n.clone();a.attr("colspan","1"),n.remove();var i=$("#".concat(e));i.closest("td").attr("colspan","1"),i.closest("tr").append(a)}function hideFieldsAndSections(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!function hideFields(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];document.querySelectorAll('tr:has([id$="_label"])').forEach((function(t){t.style.display=e?"none":""}))}(e),function hideFieldSets(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];document.querySelectorAll("fieldset[aria-label]").forEach((function(t){t.style.display=e?"none":""}))}(e)}function deepExtend(e){e=e||{};for(var t=1,n=arguments.length;t<n;++t){var a=arguments[t];if(a)for(var i in a)a.hasOwnProperty(i)&&"__proto__"!=i&&"constructor"!=i&&("[object Object]"!==Object.prototype.toString.call(a[i])?e[i]=a[i]:e[i]=deepExtend(e[i],a[i]))}return e}var w=[n.DEV,n.TEST,n.PROD],F=[a[n.DEV],a[n.TEST],a[n.PROD]],O={autoinit:!0,env:n.DEV,logging:!0,logLevel:90,form:null,allowedHosts:[].concat(F),allowedPaths:[].concat(["/claim/","/claim-dev/","/application/","/application-dev/"]),allowedEnvs:[].concat(w)},C=null;function getOptions(){return C||O}function setOption(e,t){O[e]=t}deepExtend({},O);var T=Logger("common/scripts");m.useScript=useScript;var P={jquerymask:"jquerymask"},A={loadmap:[],sourcemap:{jquery:"https://code.jquery.com/jquery-3.6.2.min.js",chosen:"https://cdnjs.cloudflare.com/ajax/libs/chosen/1.4.2/chosen.jquery.js",jquerymask:"https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"},callstack:{}};function useScript(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e&&null!==(n=A.sourcemap)&&void 0!==n&&n[e]){var r=A.sourcemap[e];if(function isScriptAdded(e){var n;if(e&&null!==(n=A.sourcemap)&&void 0!==n&&n[e]){var a=A.sourcemap[e];return Boolean(t.querySelector('script[src="'+a+'"]'))}}(e)){if(function isScriptFullyLoaded(e){return e in A.loadmap&&A.loadmap[e]}(e))return T.warn({fn:useScript,message:"Script already loaded. Skipping: ".concat(e)}),void(a&&(T.warn({fn:useScript,message:"Script already loaded. Calling onload for: ".concat(e)}),a()));var o,c;a?(T.warn({fn:useScript,message:"Script still loading, adding to call stack: ".concat(e),data:A}),A.callstack=_objectSpread2(_objectSpread2({},A.callstack?A.callstack:{}),{},_defineProperty({},e,[].concat(_toConsumableArray(null!==(o=A.callstack)&&void 0!==o&&o[e]?null===(c=A.callstack)||void 0===c?void 0:c[e]:[]),[a])))):T.warn({fn:useScript,message:"Script still loading: ".concat(e)})}else{var l=t.createElement("script");l.setAttribute("async",""),l.src=r,t.head.appendChild(l),a&&"function"==typeof a&&(A.callstack=_objectSpread2(_defineProperty({},e,[a]),A.callstack)),l.onload=function(){var t,n;T.info({fn:useScript,message:"script onload successfully called ".concat(e),data:A}),function markScriptFullyLoaded(e){A.loadmap[e]=!0}(e),null!==(t=A.callstack)&&void 0!==t&&t[e]&&(null===(n=A.callstack)||void 0===n||n[e].forEach((function(e){return e()})),A.callstack=_objectSpread2(_objectSpread2({},A.callstack?A.callstack:{}),{},_defineProperty({},e,[])))},l.onerror=function(){T.error({fn:useScript,message:"Failed to load: ".concat(e)}),i&&"function"==typeof i&&i()}}}}var D=["programId","beforeSend","onSuccess"],R=["programId","beforeSend","onSuccess"],I=["onSuccess"],E=["searchStr","onSuccess"],k=["topicSourceId"],x=["topicId"],N=Logger("common/fetch");m.fetch={getEnvVarsData:getEnvVarsData,getApplicationFormData:getApplicationFormData,getClaimFormData:getClaimFormData,getMunicipalData:getMunicipalData,getOrgbookAutocompleteData:getOrgbookAutocompleteData,getOrgbookTopicData:function getOrgbookTopicData(e){return _getOrgbookTopicData.apply(this,arguments)},getOrgbookCredentialsData:function getOrgbookCredentialsData(e){return _getOrgbookCredentialsData.apply(this,arguments)}};var B={get_env_vars_data:"/_api/environmentvariabledefinitions?$filter=contains(schemaname,'quartech_')&$select=schemaname,environmentvariabledefinitionid&$expand=environmentvariabledefinition_environmentvariablevalue($select=value)",get_application_form_data:function get_application_form_data(e){return"/_api/msgov_programs(".concat(e,")?$select=msgov_programid, quartech_disabledchefsdemographicinfo, msgov_programname, quartech_applicantportalprogramname, quartech_applicantportalprogramstreamjsonconfig, quartech_portalapplicationpagetitle, quartech_portalapplicationpagesubtitle, quartech_portalapplicationpagedescription, quartech_programabbreviation, quartech_programemailaddress, quartech_portalappactivityinfohiddenfields, quartech_portalappprojectdeschiddenfields, quartech_portalappfieldsdisplaynamesmapping, quartech_typesofbusinesstodisplay, quartech_applicantportalapplicationformconfigjson, quartech_activitiestypestodisplay&$expand=quartech_ApplicantPortalConfig($select=quartech_name,quartech_configdata)")},get_claim_form_data:function get_claim_form_data(e){return"/_api/msgov_programs(".concat(e,")?$select=msgov_programid, msgov_programname, quartech_applicantportalprogramname, quartech_claimformheaderhtmlcontent, quartech_applicantportalclaimformjson, quartech_applicantportalprogramstreamjsonconfig, quartech_portalapplicationpagetitle, quartech_portalapplicationpagesubtitle, quartech_portalapplicationpagedescription, quartech_programabbreviation, quartech_programemailaddress, quartech_portalappactivityinfohiddenfields, quartech_portalappprojectdeschiddenfields, quartech_portalappfieldsdisplaynamesmapping, quartech_typesofbusinesstodisplay, quartech_applicantportalapplicationformconfigjson, quartech_activitiestypestodisplay&$expand=quartech_ApplicantPortalConfig($select=quartech_name,quartech_configdata)")},get_municipal_data:"/_api/quartech_municipals?$select=quartech_name,quartech_municipalid&$expand=quartech_RegionalDistrict($select=quartech_name,quartech_regionaldistrictid,_quartech_censusofagricultureregion_value)",get_orgbook_autocomplete_data:"https://orgbook.gov.bc.ca/api/v3/search/autocomplete",get_orgbook_topic_data:"https://orgbook.gov.bc.ca/api/v4/search/topic",get_orgbook_credentials_data:function get_orgbook_credentials_data(e){return"https://orgbook.gov.bc.ca/api/v4/topic/".concat(e,"/credential-set")}},j={json:"application/json; charset=utf-8"},L={json:"json"},V=function setODataHeaders(e){e.setRequestHeader("Accept","application/json"),e.setRequestHeader("OData-MaxVersion","4.0"),e.setRequestHeader("OData-Version","4.0"),e.setRequestHeader("Prefer",'odata.include-annotations="*"')},z={};function fetch(e){return _fetch.apply(this,arguments)}function _fetch(){return(_fetch=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(e){var t,n,a,i,r,o,c,l,s,d,u,p,h,g,m,f,v,y,b,_,q,S,w;return _regeneratorRuntime().wrap((function _callee$(F){for(;;)switch(F.prev=F.next){case 0:if(t=e.method,n=void 0===t?"GET":t,a=e.url,i=e.beforeSend,r=e.onSuccess,o=e.onError,c=e.async,l=void 0===c||c,s=e.data,d=void 0===s?{}:s,u=e.datatype,p=e.contentType,h=e.includeODataHeaders,g=void 0!==h&&h,m=e.skipCache,f=void 0!==m&&m,v=e.returnData,y=void 0!==v&&v,b=JSON.stringify(e),f||!z[b]){F.next=8;break}if(_=z[b],q=_.data,S=_.textStatus,w=_.xhr,N.info({fn:fetch,message:"returning cached data for url: ".concat(a),data:{data:q,params:e}}),!y){F.next=7;break}return F.abrupt("return",Promise.resolve(q));case 7:return F.abrupt("return",Promise.resolve(r(q,S,w)));case 8:return F.abrupt("return",$.ajax({method:n,url:a,contentType:p,datatype:u,data:d,async:l,beforeSend:function beforeSend(e){g&&V(e),i&&"function"==typeof i&&i()},success:function success(t,n,i){f||(z[b]={data:t,textStatus:n,xhr:i}),y?N.info({fn:fetch,message:"skipping onSuccess handler call: ".concat(a),data:{data:t,params:e}}):r&&"function"==typeof r&&r(t,n,i)},error:function error(e,t,n){N.error({fn:fetch,message:null==e?void 0:e.responseText,data:{xhr:e,textStatus:t,errorThrown:n}}),o&&"function"==typeof o&&o(e,t,n)}}).then((function(t){if(y&&t)return N.info({fn:fetch,message:"returning data for url: ".concat(a),data:{data:t,params:e}}),Promise.resolve(t)})));case 9:case"end":return F.stop()}}),_callee)})))).apply(this,arguments)}function getEnvVarsData(){return _getEnvVarsData.apply(this,arguments)}function _getEnvVarsData(){return _getEnvVarsData=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(){var e,t,n=arguments;return _regeneratorRuntime().wrap((function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:return t=_extends({},(_objectDestructuringEmpty(e=n.length>0&&void 0!==n[0]?n[0]:{}),e)),a.abrupt("return",fetch(_objectSpread2({url:B.get_env_vars_data,contentType:j.json,datatype:L.json,includeODataHeaders:!0,async:!1,returnData:!0},t)));case 2:case"end":return a.stop()}}),_callee2)}))),_getEnvVarsData.apply(this,arguments)}function getApplicationFormData(e){return _getApplicationFormData.apply(this,arguments)}function _getApplicationFormData(){return(_getApplicationFormData=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(e){var t,n,a,i;return _regeneratorRuntime().wrap((function _callee3$(r){for(;;)switch(r.prev=r.next){case 0:return t=e.programId,n=e.beforeSend,a=e.onSuccess,i=_objectWithoutProperties(e,D),r.abrupt("return",fetch(_objectSpread2({url:B.get_application_form_data(t),contentType:j.json,datatype:L.json,includeODataHeaders:!0,async:!1,beforeSend:n,onSuccess:a},i)));case 2:case"end":return r.stop()}}),_callee3)})))).apply(this,arguments)}function getClaimFormData(e){return _getClaimFormData.apply(this,arguments)}function _getClaimFormData(){return(_getClaimFormData=_asyncToGenerator(_regeneratorRuntime().mark((function _callee4(e){var t,n,a,i;return _regeneratorRuntime().wrap((function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:return t=e.programId,n=e.beforeSend,a=e.onSuccess,i=_objectWithoutProperties(e,R),r.abrupt("return",fetch(_objectSpread2({url:B.get_claim_form_data(t),contentType:j.json,datatype:L.json,includeODataHeaders:!0,async:!1,beforeSend:n,onSuccess:a},i)));case 2:case"end":return r.stop()}}),_callee4)})))).apply(this,arguments)}function getMunicipalData(e){return _getMunicipalData.apply(this,arguments)}function _getMunicipalData(){return(_getMunicipalData=_asyncToGenerator(_regeneratorRuntime().mark((function _callee5(e){var t,n,a;return _regeneratorRuntime().wrap((function _callee5$(i){for(;;)switch(i.prev=i.next){case 0:return t=e.onSuccess,n=void 0===t?null:t,a=_objectWithoutProperties(e,I),i.abrupt("return",fetch(_objectSpread2({url:B.get_municipal_data,contentType:j.json,datatype:L.json,includeODataHeaders:!0,async:!1,onSuccess:n},a)));case 2:case"end":return i.stop()}}),_callee5)})))).apply(this,arguments)}function getOrgbookAutocompleteData(e){return _getOrgbookAutocompleteData.apply(this,arguments)}function _getOrgbookAutocompleteData(){return(_getOrgbookAutocompleteData=_asyncToGenerator(_regeneratorRuntime().mark((function _callee6(e){var t,n,a;return _regeneratorRuntime().wrap((function _callee6$(i){for(;;)switch(i.prev=i.next){case 0:return t=e.searchStr,n=e.onSuccess,a=_objectWithoutProperties(e,E),i.abrupt("return",fetch(_objectSpread2({url:B.get_orgbook_autocomplete_data,data:{q:t,inactive:"false",revoked:"false",latest:"true"},onSuccess:n},a)));case 2:case"end":return i.stop()}}),_callee6)})))).apply(this,arguments)}function _getOrgbookTopicData(){return(_getOrgbookTopicData=_asyncToGenerator(_regeneratorRuntime().mark((function _callee7(e){var t,n;return _regeneratorRuntime().wrap((function _callee7$(a){for(;;)switch(a.prev=a.next){case 0:return t=e.topicSourceId,n=_objectWithoutProperties(e,k),a.abrupt("return",fetch(_objectSpread2({url:B.get_orgbook_topic_data,data:{q:t}},n)));case 2:case"end":return a.stop()}}),_callee7)})))).apply(this,arguments)}function _getOrgbookCredentialsData(){return(_getOrgbookCredentialsData=_asyncToGenerator(_regeneratorRuntime().mark((function _callee8(e){var t,n;return _regeneratorRuntime().wrap((function _callee8$(a){for(;;)switch(a.prev=a.next){case 0:return t=e.topicId,n=_objectWithoutProperties(e,x),a.abrupt("return",fetch(_objectSpread2({url:B.get_orgbook_credentials_data(t)},n)));case 2:case"end":return a.stop()}}),_callee8)})))).apply(this,arguments)}"function"==typeof SuppressedError&&SuppressedError;const Q=Logger("common/env");function getEnvVars(){var e;return function __awaiter(e,t,n,a){return new(n||(n=Promise))((function(i,r){function fulfilled(e){try{step(a.next(e))}catch(e){r(e)}}function rejected(e){try{step(a.throw(e))}catch(e){r(e)}}function step(e){e.done?i(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){const t=yield getEnvVarsData();if(null===(e=null==t?void 0:t.value)||void 0===e?void 0:e.length){const e=t.value.reduce(((e,t)=>{var n,a;const i=t.schemaname,r=null===(a=null===(n=t.environmentvariabledefinition_environmentvariablevalue)||void 0===n?void 0:n[0])||void 0===a?void 0:a.value;return Object.assign(Object.assign({},e),{[i]:r})}),{});return Q.info({fn:getEnvVars,message:"successfully extracted env vars:",data:e}),Promise.resolve(e)}let n="failed to extract env vars from data";return Q.warn({fn:getEnvVars,message:n,data:t}),Promise.reject(new Error(n))}))}m.env={getEnvVars:getEnvVars,getEnv:function getEnv(){const{host:t}=e.location,n=Object.keys(a).find((e=>a[e]===t));if(n)return n;Q.error({fn:getEnv,message:"Unable to determine current env",data:{host:t,Hosts:a}})}};var G=Logger("common/loading");function hideLoadingAnimation(){G.info({fn:hideLoadingAnimation,message:"attempting to hide loading animation..."});var e,n=t.getElementById("loader");n?(G.info({fn:hideLoadingAnimation,message:"loader found & finished loading, removing element"}),null===(e=n.parentNode)||void 0===e||e.removeChild(n)):G.warn({fn:hideLoadingAnimation,message:"loader not found!"});var a,i=t.getElementById("loader-style");i?(G.info({fn:hideLoadingAnimation,message:"loaderStyle found & finished loading, removing element"}),null===(a=i.parentNode)||void 0===a||a.removeChild(i)):G.warn({fn:hideLoadingAnimation,message:"loaderStyle not found!"})}function setOnKeypressBudgetInput(e){$(document).on("keypress","#".concat(e),(function(){calculateEstimatedActivityBudget()}))}function calculateEstimatedActivityBudget(){var e=parseFloat($("#quartech_smefee").val().replace(/,/g,""));isNaN(e)&&(e=0);var t=e+showOrHideAndReturnValue("quartech_smetravelairfareparkingetc","quartech_pleasedescribemodeoftravelifapplicable")+showOrHideAndReturnValue("quartech_smeaccommodation","quartech_pleasedescribeaccommodationwherewillthesme")+showOrHideAndReturnValue("quartech_facilityequipmenttechnologyrental","quartech_pleasedescribeequipmentrequiredifapplicable")+showOrHideAndReturnValue("quartech_advertisingcommunications","quartech_pleasedescribewhatformsofadvertisingcommunic")+showOrHideAndReturnValue("quartech_administrationcosts","quartech_pleasedescribetheadministrativecoststobeinc")+showOrHideAndReturnValue("quartech_othercost","quartech_pleaseexplainotherifapplicable"),n=t-showOrHideAndReturnValue("quartech_costsharecontributioncashorinkinddonation","quartech_pleaseexplainwhotheotherpartnersareandwha"),a=H.format(t);$("#quartech_estimatedbudgettotalactivitycost").val(a.replace("CA$",""));var i=H.format(n);$("#quartech_totalfundingrequiredfromtheprogram").val(i.replace("CA$",""))}var M=Logger("common/currency"),H=new Intl.NumberFormat("en-US",{style:"currency",currency:"CAD",maximumFractionDigits:2});function customizeCurrencyInput(e){var t=e.inputId,n=e.skipCalculatingBudget,a=void 0!==n&&n,i=e.maxDigits,r=void 0===i?10:i,o=e.limitInputValue,c=void 0===o?void 0:o,l=e.hideDollarSign,s=void 0!==l&&l;e.emptyInitialValue;var d=e.allowNegatives,u=void 0!==d&&d,p=$("#".concat(t));if(!document.querySelector("#".concat(t,"_span_currency_label"))&&!p.val()&&!s){p.parent().addClass("input-group");var h=document.createElement("span");h.id="".concat(t,"_span_currency_label"),h.innerText="$",h.className="input-group-addon",p.parent().prepend(h)}p.on("keydown",(function(e){var t=p.val(),n=e.which,a=document.getElementById(p[0].id).selectionStart;if(190===n&&"."===t.charAt(a))return document.getElementById(p[0].id).setSelectionRange(a+1,a+1),void e.preventDefault();if(46===n){var i=t.charAt(a);if("0"===i&&0===a)return document.getElementById(p[0].id).setSelectionRange(a+1,a+1),void e.preventDefault();if("."===i||","===i)return document.getElementById(p[0].id).setSelectionRange(a+1,a+1),void e.preventDefault();var r=!1;if(a>=t.length-2&&(r=!0),r&&a!==t.length){var o=t.substring(0,a)+"0"+t.substring(a+1);return p.val(o),document.getElementById(p[0].id).setSelectionRange(a+1,a+1),void e.preventDefault()}}if(8===n){var c=t.charAt(a-1);if("."===c||","===c)return document.getElementById(p[0].id).setSelectionRange(a-1,a-1),void e.preventDefault();if(a>=t.length-2){var l=t.substring(0,a-1)+"0"+t.substring(a);return p.val(l),document.getElementById(p[0].id).setSelectionRange(a-1,a-1),void e.preventDefault()}}})),p.on("focusin",(function(e){$(this).data("val",$(this).val())})),p.on("input",(function(e){handleNewValueEntered($(this),a)})),p.on("keypress",(function(e){var t=e.which;if(t>=48&&t<=57||45===t&&u){var n=p.val(),i=n.includes("-"),o=document.getElementById(p[0].id).selectionStart;if(t>=49&&t<=57&&"0.00"===n&&0===o){var l=n.split("");return l[0]=String.fromCharCode(t),l=l.join(""),p.val(l),document.getElementById(p[0].id).setSelectionRange(o+1,o+1),void e.preventDefault()}if((n.length>0&&!i||n.length>1&&i)&&n.length===o)return void e.preventDefault();if(45===t&&u){if(0!==o||n.includes("-"))return void e.preventDefault();if(0===o){var s=parseFloat(n.replace(/,/g,""));s&&0!=s?(p.val("-".concat(s.toFixed(2))),document.getElementById(p[0].id).setSelectionRange(0,0),handleNewValueEntered(p,a),e.preventDefault()):""!=n&&"0.00"!==n||p.val("-")}return void e.preventDefault()}if(c){var d=parseFloat(n.replace(/,/g,"")),h=parseFloat(c.replace(/,/g,""));isNaN(d)&&(d=0),d>h&&p.val(c)}var g=r;if(n.length,i&&(g+=1),o>0&&n.length-2>0&&o>=n.length-2){var m=n.split("");return m[o]=String.fromCharCode(t),m=m.join(""),p.val(m),document.getElementById(p[0].id).setSelectionRange(o+1,o+1),void e.preventDefault()}if(n.length<=g)return}e.preventDefault()}))}function handleNewValueEntered(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.val(),a=n.includes("-"),i=n.replace(/,/g,"").replace("$","").replaceAll("-","");isNaN(i)&&(i=0);var r=H.format(i);if(r){M.info({fn:handleNewValueEntered,message:"newAmountWithCurrencyFormat: ".concat(r)});var o=document.getElementById(e[0].id).selectionStart,c=r.replace("CA$","");e.val("".concat(a?"-":"").concat(c)),t||calculateEstimatedActivityBudget();var l=!1;n.length>e.data("val").length&&(l=!0);var s=(e.data("val").match(/,/g)||[]).length;(e.val().match(/,/g)||[]).length!==s&&(l?o++:o-1>=0?o--:o=0),document.getElementById(e[0].id).setSelectionRange(o,o)}e.data("val",e.val())}var W=Logger("common/masking"),J={CRA:"CRA",PostalCode:"PostalCode",PhoneNumber:"PhoneNumber",Number:"Number",Email:"Email"},K={CRA:"000000000",PostalCode:"S0S 0S0",PhoneNumber:"(000) 000-0000"};function maskInput(e,t){W.info({fn:maskInput,message:"applying mask input to fieldName: ".concat(e," of type: ").concat(t)}),Object.keys(J).includes(t)?useScript(P.jquerymask,(function(){var n,a,i;switch(t){case J.CRA:case J.PostalCode:case J.PhoneNumber:null===(n=$("#".concat(e)))||void 0===n||n.mask(K[t]);break;case J.Email:null===(a=$("#".concat(e)))||void 0===a||a.mask("A",{translation:{A:{pattern:/[\w@\-.+]/,recursive:!0}}});break;case J.Number:null===(i=$("#".concat(e)))||void 0===i||i.mask("Z#",{translation:{Z:{pattern:/[1-9]/}}});break;default:return void W.error({fn:maskInput,message:"did NOT apply masking to fieldName: ".concat(e," of type: ").concat(t)})}W.info({fn:maskInput,message:"successfully applied mask input to fieldName: ".concat(e," of type: ").concat(t)})})):W.error({fn:maskInput,message:"unsupported mask, cannot mask input for fieldName: ".concat(e," and type: ").concat(t)})}function setupTooltip(e){var t=e.name,n=e.tooltipText,a=e.tooltipTargetElementId;if(n){var i=$("#".concat(null!=a?a:t));i.attr("data-content",n),i.attr("data-placement","bottom"),i.attr("data-html","true"),i.attr("data-trigger","hover"),i.attr("data-original-title",""),i.popover({trigger:"manual",html:!0,animation:!1}).on("mouseenter",(function(){var e=this;$(this).popover("show"),$(".popover").on("mouseleave",(function(){$(e).popover("hide")}))})).on("mouseleave",(function(){var e=this;setTimeout((function(){$(".popover:hover").length||$(e).popover("hide")}),300)}))}}var U=Logger("common/setRequired");function setStepRequiredFields(e){var t;if(t=getOptions().form===o.Application?getFieldsBySectionNew(e):getFieldsBySection(e)){for(var n=0;n<t.length;n++){var a=t[n],i=a.name,r=a.elementType,l=a.required,s=a.validation,d=a.hidden,u=a.format,p=a.allowNegatives,h=a.maxDigits,g=a.emptyInitialValue,m=a.maxLength,f=a.label,v=a.type,y=a.tooltipText,b=a.tooltipTargetElementId,_=a.skipCalculatingBudget,q=void 0===_?void 0:_,S=a.hideLabel,w=a.readOnly,F=a.doNotBlank,O=void 0!==F&&F,C=a.fileTypes;if(U.info({fn:setStepRequiredFields,message:"setting field definition for ".concat(i)}),(E=i)!==E.toLowerCase()&&U.warn({fn:setStepRequiredFields,message:"Warning! Field name: ".concat(i," contains an uppercase letter, please confirm if it was intentional or not.")}),"SectionTitle"===v&&d){var T=$('fieldset[aria-label="'.concat(i,'"]'));T&&(null==T||T.css("display","none"))}else{if(setupTooltip({name:i,tooltipText:y,tooltipTargetElementId:b}),f){var P,A,D=null===(P=$("#".concat(i,"_label")))||void 0===P?void 0:P.text(f);null==D||D.html(null==D||null===(A=D.html())||void 0===A?void 0:A.replace(/\n/g,"<br/>"))}var R,I;if(S&&(null===(R=$("#".concat(i,"_label")))||void 0===R||R.css("display","none")),l&&(r?setRequiredField(i,r):setRequiredField(i)),s&&addValidationCheck(i,s),d&&hideFieldByFieldName(i,validateStepFields(e),O),m&&setInputMaxLength(i,m),w&&setFieldReadOnly(i),"email"===u?(maskInput(i,J.Email),validateEmailAddressField(i)):"currency"===u?customizeCurrencyInput(_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2({inputId:i},void 0!==q?{skipCalculatingBudget:q}:{skipCalculatingBudget:!0}),h?{maxDigits:h}:{maxDigits:13}),g&&{emptyInitialValue:g}),p&&{allowNegatives:p})):"percentage"===u?customizeCurrencyInput({inputId:i,skipCalculatingBudget:!0,maxDigits:5,limitInputValue:"100.00",hideDollarSign:!0}):"number"===u?$("#".concat(i)).attr("type","number"):"cra"===u?maskInput(i,J.CRA):"phoneNumber"===u?maskInput(i,J.PhoneNumber):"postalCode"===u&&maskInput(i,J.PostalCode),r===c.FileInput)null===(I=$("#".concat(i,"_AttachFile")))||void 0===I||I.attr("accept",null!=C?C:".csv,.doc,.docx,.odt,.pdf,.xls,.xlsx,.ods,.gif,.jpeg,.jpg,.png,.svg,.tif")}}var E;setDynamicallyRequiredFields(e)}}function setRequiredField(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.Input,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Required field";$("#".concat(e,"_label")).parent().addClass("required"),$("#".concat(e)).attr("required",!0);var a=document.createElement("div");switch(a.id="".concat(e,"_error_message"),a.className="error_message",a.style="display:none;",a.innerHTML="<span'>".concat(n,"</span>"),$("#".concat(e)).parent().append(a),t){case c.FileInput:observeChanges($("input[id=".concat(e,"_AttachFile]"))[0]),$("#".concat(e,"_AttachFile")).on("blur input",(function(){validateRequiredFields()}));break;case c.DatePicker:observeChanges($("input[id=".concat(e,"_datepicker_description]")).parent()[0]),$("#".concat(e,"_datepicker_description")).on("blur input",(function(){validateRequiredFields()}));break;case c.SingleOptionSet:case c.MultiOptionSet:$("input[id*='".concat(e,"']")).on("change",(function(){validateRequiredFields(),U.info({fn:setRequiredField,message:"Q3 updated... validateRequiredFields..."})}));break;case c.DropdownSelect:$("select[id*='".concat(e,"']")).on("change",(function(){validateRequiredFields()}));break;default:$("#".concat(e)).on("change keyup",(function(e){validateRequiredFields()}))}}function setDynamicallyRequiredFields(e){var t;(t=getOptions().form===o.Application?getFieldsBySectionNew(e):getFieldsBySection(e))&&Object.keys(localStorage).filter((function(e){return e.startsWith("shouldRequire_")})).forEach((function(e){var n=e.replace("shouldRequire_",""),a=t.find((function(e){return e.name===n}));a&&a.elementType?setRequiredField(n,a.elementType):setRequiredField(n)}))}function initOnChange_DependentRequiredField(e){var t=e.dependentOnValue,n=e.dependentOnValueArray,a=e.dependentOnElementTag,i=e.requiredFieldTag,r=e.overrideTruthyClause,o=void 0===r?void 0:r,c=e.validationFunc,l=e.setRequiredFieldsFunc,s=e.disableRequiredProp,d=void 0!==s&&s,u=e.customFunc,p=document.querySelector("#".concat(a));p&&(setupDependentRequiredField({dependentOnValue:t,dependentOnValueArray:n,dependentOnElementTag:a,requiredFieldTag:i,overrideTruthyClause:o,validationFunc:c,setRequiredFieldsFunc:l,disableRequiredProp:d,customFunc:u}),$(p).on("change",(function(){setupDependentRequiredField({dependentOnValue:t,dependentOnValueArray:n,dependentOnElementTag:a,requiredFieldTag:i,overrideTruthyClause:o,validationFunc:c,setRequiredFieldsFunc:l,disableRequiredProp:d,customFunc:u})})))}function setupDependentRequiredField(e){var t=e.dependentOnValue,n=e.dependentOnValueArray,a=void 0===n?[]:n,i=e.dependentOnElementTag,r=e.requiredFieldTag,o=e.overrideTruthyClause,c=void 0===o?void 0:o,l=e.validationFunc,s=e.setRequiredFieldsFunc,d=e.disableRequiredProp,u=void 0!==d&&d,p=e.customFunc,h=document.querySelector("#".concat(i));if(h){var g=h.value;null!=c?shouldRequireDependentField(!0===c?{shouldBeRequired:!0,requiredFieldTag:r,validationFunc:l,setRequiredFieldsFunc:s,disableRequiredProp:u,customFunc:p}:{shouldBeRequired:!1,requiredFieldTag:r,validationFunc:l,setRequiredFieldsFunc:s,disableRequiredProp:u,customFunc:p}):g===t||a.includes(g)?shouldRequireDependentField({shouldBeRequired:!0,requiredFieldTag:r,validationFunc:l,setRequiredFieldsFunc:s,disableRequiredProp:u,customFunc:p}):shouldRequireDependentField({shouldBeRequired:!1,requiredFieldTag:r,validationFunc:l,setRequiredFieldsFunc:s,disableRequiredProp:u,customFunc:p})}}function shouldRequireDependentField(e){var t,n=e.shouldBeRequired,a=e.requiredFieldTag,i=e.validationFunc,r=void 0===i?validateStepFields:i,o=e.setRequiredFieldsFunc,c=void 0===o?setDynamicallyRequiredFields:o,l=e.disableRequiredProp,s=e.customFunc,d=document.querySelector("#".concat(a,"_label")),u=d.closest("tr"),p=document.querySelector("#".concat(a));d&&u&&p&&(n?($(u).css({display:""}),l||(localStorage.setItem("shouldRequire_".concat(a),!0),c&&c(getCurrentStep()),r&&(r(getCurrentStep()),$(p).change((function(){r(getCurrentStep())}))))):($(u).css({display:"none"}),l||($("#".concat(a,"_label")).parent().removeClass("required"),localStorage.removeItem("shouldRequire_".concat(a)),c&&c(getCurrentStep()),r&&r(getCurrentStep()),$(p).off("change")),null===(t=$("#".concat(a,"_name")))||void 0===t||t.val(""),$(p).val("")),s&&s())}var Y=Logger("application/steps/applicantInfo");function initOnChange_PreviouslyReceivedKttpFunding(){var e=$("#quartech_hasthisorganizationreceivedkttpfundingin");hideShow_for_PreviouslyReceivedKttpFunding(e.val()),Y.info({fn:initOnChange_PreviouslyReceivedKttpFunding,message:"initOnChange_PreviouslyReceivedKttpFunding called."}),e.on("change",(function(){var e=$(this).val();Y.info({fn:initOnChange_PreviouslyReceivedKttpFunding,message:"Selected Value: ".concat(e)}),hideShow_for_PreviouslyReceivedKttpFunding(e)}))}function hideShow_for_PreviouslyReceivedKttpFunding(e){var t="none";e===d&&(t="table-row"),$("#quartech_ifyespleaseexplainwhenandforwhichactivity").parent().parent().parent().css("display",t)}function initOnChange_OrganizationReceivedFundingFromBC(){var e=$("#quartech_hasthisorganizationreceivedfundingfrmother");hideShow_for_OrganizationReceivedFundingFromBC(e.val()),Y.info({fn:initOnChange_OrganizationReceivedFundingFromBC,message:"initOnChange_OrganizationReceivedFundingFromBC called."}),e.on("change",(function(){var e=$(this).val();Y.info({fn:initOnChange_OrganizationReceivedFundingFromBC,message:"Selected Value: ".concat(e)}),hideShow_for_OrganizationReceivedFundingFromBC(e)}))}function hideShow_for_OrganizationReceivedFundingFromBC(e){var t="none";e===d&&(t="table-row"),$("#quartech_ifyespleaseexplainwhenandfromwhichprogram").parent().parent().parent().css("display",t)}function initOnChange_IsCollaboratingWithOtherOrganizationQuestion(){var e=$("#quartech_areyoucollaboratingwithanyotherorg");hideShow_for_CollaboratingWithOtherOrgsControl(e.val()),Y.info({fn:initOnChange_IsCollaboratingWithOtherOrganizationQuestion,message:"initOnChange_IsCollaboratingWithOtherOrganizationQuestion called."}),e.on("change",(function(){var e=$(this).val();Y.info({fn:initOnChange_IsCollaboratingWithOtherOrganizationQuestion,message:"Selected Value: ".concat(e)}),hideShow_for_CollaboratingWithOtherOrgsControl(e)}))}function hideShow_for_CollaboratingWithOtherOrgsControl(e){var t="none";e===d&&(t="table-row"),$("#quartech_ifyespleaseprovidelegalbusinessorganization").parent().parent().parent().css("display",t),$("#quartech_ifyespleaseprovideacontactname").parent().parent().parent().css("display",t),$("#quartech_ifyespleaseprovideabriefbackgroundoutlinin").parent().parent().parent().css("display",t)}function initOnChange_ActivityOverMultipleDays(){var e=$("#quartech_doestheactivitytakeplaceovermultipleday");hideShow_for_ActivityOverMultipleDays(e.val()),Y.info({fn:initOnChange_ActivityOverMultipleDays,message:"initOnChange_ActivityOverMultipleDays called."}),e.on("change",(function(){var e=$(this).val();Y.info({fn:initOnChange_ActivityOverMultipleDays,message:"Selected Value: ".concat(e)}),hideShow_for_ActivityOverMultipleDays(e)}))}function hideShow_for_ActivityOverMultipleDays(e){var t="none";e===d?t="table-row":$("#quartech_ifyespleaseprovidetheadditionaldates").val(""),$("#quartech_ifyespleaseprovidetheadditionaldates").parent().parent().parent().css("display",t)}function initOnChange_AdaptedEventForAdultLearning(){var e=$("#quartech_theprocessoflearningandprocessingknowledge");hideShow_for_AdaptedEventForAdultLearning(e.val()),Y.info({fn:initOnChange_AdaptedEventForAdultLearning,message:"initOnChange_AdaptedEventForAdultLearning called."}),e.on("change",(function(){var e=$(this).val();Y.info({fn:initOnChange_AdaptedEventForAdultLearning,message:"Selected Value: ".concat(e)}),hideShow_for_AdaptedEventForAdultLearning(e)}))}function hideShow_for_AdaptedEventForAdultLearning(e){var t="none";e===d?t="table-row":$("#quartech_ifyespleasedescribehowtheproposedactivitie").val(""),$("#quartech_ifyespleasedescribehowtheproposedactivitie").parent().parent().parent().css("display",t)}function showHideForApplicantWithAndWithoutCRA_GST(e){var t=$("#quartech_businessregistrationnumber"),n=t.parent().parent().parent(),a=$("#quartech_reasonwhynocraorgstnumber"),i=a.parent().parent().parent();e?(t.val(""),n.css("display","none"),i.css("display","table-row")):(a.val(""),i.css("display","none"),n.css("display","table-row")),validateStepFields("ApplicantInfoStep")}function getTopic(e){$.ajax({url:"https://orgbook.gov.bc.ca/api/v4/search/topic",data:{q:e.topic_source_id}}).done((function(t){getTopicCredentials(t.total&&t.results.find((function(t){return t.source_id===e.topic_source_id}))||null)})).fail((function(e){Y.error({fn:getTopic,message:"Unable to get topic",data:e})}))}function getTopicCredentials(e){e&&e.id&&$.ajax({url:"https://orgbook.gov.bc.ca/api/v4/topic/"+e.id+"/credential-set"}).done((function(e){!function updateBusinessNumberField(e,t){var n=t.find((function(e){return"business_number.registries.ca"===e.credential_type.description})),a=document.querySelector("#quartech_businessregistrationnumber");if(a&&n){var i=n.attributes.find((function(e){return"business_number"===e.type}));a.value=i&&i.value||"",$(a).trigger("change")}}(0,e&&e.length&&e.reduce((function(e,t){return e.concat(t.credentials.filter((function(e){return e.id===t.latest_credential_id})))}),[]).filter((function(e){return!e.revoked})))})).fail((function(e){Y.error({fn:getTopicCredentials,message:"Unable to get topic credentials",data:e})}))}function setShowOrHideTipNotice(){showOrHideTipNotice(),$("#quartech_tipreportenrolled").on("change",(function(){showOrHideTipNotice()})),$("#quartech_agriprogramsubscriber").on("change",(function(){showOrHideTipNotice()}))}function showOrHideTipNotice(){var e=document.querySelector("#quartech_agriprogramsubscriber").value,t=document.querySelector("#quartech_tipreportenrolled").value,n=document.querySelector("#tipReportNotice");n&&("255550001"!==e||"255550002"!==t&&"255550000"!==t?$(n).css({display:"none"}):$(n).css({display:""}))}function processLocationData(e){return(null==e?void 0:e.value).reduce(((e,t)=>{const{quartech_name:n,quartech_RegionalDistrict:a}=t,{quartech_name:i}=null!=a?a:{quartech_name:"Other"};return e[i]?e[i].push(n):e[i]=[n],e}),{})}m.locations={processLocationData:processLocationData};var Z=Logger("application/steps/project");function initOnChange_ActiviyOpenToPublic(){var e=$("#quartech_willthisactivitybeopentotheentirepublic");hideShow_WhyActiviyNotOpenToPublic(e.val()),Z.info({fn:initOnChange_ActiviyOpenToPublic,message:"initOnChange_ActiviyOpenToPublic called."}),e.on("change",(function(){var e=$(this).val();Z.info({fn:initOnChange_ActiviyOpenToPublic,message:"Selected Value: ".concat(e)}),hideShow_WhyActiviyNotOpenToPublic(e)}))}function hideShow_WhyActiviyNotOpenToPublic(e){e===d?($("#quartech_allactivitiesmustbeopentothepublicplease").parent().parent().css("display","none"),$("#quartech_allactivitiesmustbeopentothepublicplease").val("")):$("#quartech_allactivitiesmustbeopentothepublicplease").parent().parent().css("display","grid")}function setProjectStepRequiredFields(){setStepRequiredFields("ProjectStep");var e=getProgramAbbreviation();if(e&&e.includes("KTTP")){var t;initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_hasthisorganizationreceivedkttpfundingin",requiredFieldTag:"quartech_ifyespleaseexplainwhenandforwhichactivity"}),initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_hasthisorganizationreceivedfundingfrmother",requiredFieldTag:"quartech_ifyespleaseexplainwhenandfromwhichprogram"}),initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_areyoucollaboratingwithanyotherorg",requiredFieldTag:"quartech_ifyespleaseprovidelegalbusinessorganization",shouldBeRequired:!1}),initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_areyoucollaboratingwithanyotherorg",requiredFieldTag:"quartech_ifyespleaseprovideacontactname",shouldBeRequired:!1}),initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_areyoucollaboratingwithanyotherorg",requiredFieldTag:"quartech_ifyespleaseprovideabriefbackgroundoutlinin",shouldBeRequired:!1}),initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_areyouapplyingforatraceabilityknowledget",requiredFieldTag:"quartech_ifyespleaseexplainthetraceabilityactivityt"}),initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_doestheactivitytakeplaceovermultipleday",requiredFieldTag:"quartech_ifyespleaseprovidetheadditionaldates"}),initOnChange_DependentRequiredField({dependentOnValue:u,dependentOnElementTag:"quartech_willthisactivitybeopentotheentirepublic",requiredFieldTag:"quartech_allactivitiesmustbeopentothepublicplease"}),initOnChange_DependentRequiredField({dependentOnValue:p,dependentOnElementTag:"quartech_pleaseselectthemostapplicableactivitytype",requiredFieldTag:"quartech_ifotherpleasedescribeyouractivitytype"});var n=document.querySelector("#quartech_prioritytopics_i");initOnChange_DependentRequiredField((null===(t=document.querySelector("#quartech_prioritytopics_i"))||void 0===t?void 0:t.querySelector('li[aria-label="Other for Priority Topic(s)"]'))?{dependentOnElementTag:"quartech_prioritytopics_i",requiredFieldTag:"quartech_otherprioritytopic",overrideTruthyClause:!0}:{dependentOnElementTag:"quartech_prioritytopics_i",requiredFieldTag:"quartech_otherprioritytopic",overrideTruthyClause:!1}),new MutationObserver((function(e){var t;null!==(t=document.querySelector("#quartech_prioritytopics_i"))&&void 0!==t&&t.querySelector('li[aria-label="Other for Priority Topic(s)"]')?$("#quartech_otherprioritytopic_label").is(":visible")||initOnChange_DependentRequiredField({dependentOnElementTag:"quartech_prioritytopics_i",requiredFieldTag:"quartech_otherprioritytopic",overrideTruthyClause:!0}):initOnChange_DependentRequiredField({dependentOnElementTag:"quartech_prioritytopics_i",requiredFieldTag:"quartech_otherprioritytopic",overrideTruthyClause:!1})})).observe(n,{attributes:!0,childList:!0,characterData:!0}),initOnChange_DependentRequiredField({dependentOnValue:p,dependentOnElementTag:"quartech_activitypurpose",requiredFieldTag:"quartech_ifotherpleasedescribetheactivitypurpose"}),initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_theprocessoflearningandprocessingknowledge",requiredFieldTag:"quartech_adulteducationandknowlegetransferdescript"})}if(e&&"NEFBA"===e){document.querySelector("#quartech_businessgoals_note")||addTextAboveField("quartech_businessgoals","<br /><div id='quartech_businessgoals_note'><b>Note: Reimbursement for program costs will not be distributed unless you submit a complete new or updated business plan by March 1, 2024.</b><br /><br /></div>"),initOnChange_DependentRequiredField({dependentOnValue:"255550000",dependentOnElementTag:"quartech_completingcategory",requiredFieldTag:"quartech_stepstocompletethebusinessplan"}),initOnChange_DependentRequiredField({dependentOnValue:"255550001",dependentOnElementTag:"quartech_completingcategory",requiredFieldTag:"quartech_businessconsultantinformation"}),document.querySelector("#quartech_bciaregisteredconsultant_note")||addTextAboveField("quartech_bciaregisteredconsultant","<br /><div id='quartech_bciaregisteredconsultant_note'><b>Note: The consultant must be registered with BCIA or as a CPA. Please select another consultant if they are not registered with either. See the Program Guide for more information.</b></div><br />"),document.querySelector("#quartech_nefba_project_step_note")||$("#EntityFormView > div.tab.clearfix > div > div").append('\n        <div id="quartech_nefba_project_step_note">\n          <label>\n            <b>Review the Program Guide for support on how to complete or update your business plan and requirements for Phase 2 funding.</b>\n          </label>\n          <br />\n          <br />\n          <label>Reminders:</label>\n          <br />\n          <br />\n          <label>\n            If a consultant is used, an invoice and proof of payment is required for reimbursement up to a maximum amount of $3,000.\n          </label>\n          <br />\n          <br />\n          <label>\n            Note that participating in Phase 1 prepares applicants for success in the Phase 2 application process, however, does NOT guarantee funding through Phase 2. See Program Guide for full details.\n          </label>\n          <br />\n          <br />\n          <label>\n            For Phase 2 funding, a Statement of Completion from the Environmental Farm Plan (EFP) Program or commitment to apply for and, to the extent possible, complete an Environmental Farm Plan (EFP) prior to March 1, 2025 is required. Participation in the EFP program is free and confidential and applicants are encouraged to start the EFP process as soon as possible.\n          </label>\n        </div>');var a=document.querySelector("#quartech_completingcategory").value,i="255550001";a===i?(shouldRequireDependentField({shouldBeRequired:!0,requiredFieldTag:"quartech_bciaregisteredconsultant"}),setBciaOnChange()):(shouldRequireDependentField({shouldBeRequired:!1,requiredFieldTag:"quartech_bciaregisteredconsultant"}),shouldRequireDependentField({shouldBeRequired:!1,requiredFieldTag:"quartech_cpaconsultant"}),$("#quartech_bciaregisteredconsultant").off("change")),$("#quartech_completingcategory").on("change",(function(){document.querySelector("#quartech_completingcategory").value===i?(shouldRequireDependentField({shouldBeRequired:!0,requiredFieldTag:"quartech_bciaregisteredconsultant"}),setBciaOnChange()):(shouldRequireDependentField({shouldBeRequired:!1,requiredFieldTag:"quartech_bciaregisteredconsultant"}),shouldRequireDependentField({shouldBeRequired:!1,requiredFieldTag:"quartech_cpaconsultant"}),$("#quartech_bciaregisteredconsultant").off("change"))}))}if(e.includes("ABPP")||"NEFBA"===e){var r=$('fieldset[aria-label="Organization Information"]');r&&r.css("display","none");var o=$('fieldset[aria-label="Collaborating Organization Information"]');o&&o.css("display","none");var c=$('fieldset[aria-label="Activity Information"]');c&&c.css("display","none")}if(e&&e.includes("ABPP")){var l="ABPP1"===e?"event/training":"project";document.querySelector("#activityStartDateNotice")||addTextBelowField("quartech_whenistheprojectstartdate",'<div id="activityStartDateNotice" style="padding-top: 15px;">\n        Your '.concat(l," may have a delayed start date. However, all ").concat(l,"s must be submitted 90 days after the start date, unless an extension of the ").concat(l," has been granted by the Program Manager. Applications to extend any ").concat(l," will be considered on a case-by-case basis.\n      </div>")),"ABPP2"===e&&(document.querySelector("#activityEndDateNotice")||addTextBelowField("quartech_activityenddate",'<div id="activityEndDateNotice" style="padding-top: 15px;">\n        Consultants must submit the '.concat(l," report to the Applicant for review and feedback at least two weeks prior to the ").concat(l," end date. Revisions requested by the Applicant must be completed by the Consultant and approved by the Applicant prior to the final submission to the program.\n      </div>")))}"ABBP1"===getProgramAbbreviation()&&($('fieldset[aria-label="Program Category"]').css("display","none"),$('fieldset[aria-label="Consultant Information"]').css("display","none")),"ABPP2"===getProgramAbbreviation()&&(document.querySelector("#consultantNotice")||addTextAboveField("quartech_consultantcompanyname",'<div id="consultantNotice" style="padding-bottom: 15px;">\n      **Please note that the Ministry reserves the right to refuse projects submitted with consultants who are not considered to be in good standing with the Ministry. Applications with unacceptable consultants listed will be held or waitlisted and the applicants will be given an opportunity to find an acceptable consultant. \n    </div>'),document.querySelector("#moreThan10PercentNotice")||addTextBelowField("quartech_consultantcompletingoverlimit",'<div id="moreThan10PercentNotice" style="padding-top: 15px;">\n      **Please note that supporting consultants may not complete more than 40% of the proposed project. \n    </div>'))}function setBciaOnChange(){$("#quartech_bciaregisteredconsultant").on("change",(function(){"255550002"===document.querySelector("#quartech_bciaregisteredconsultant").value?shouldRequireDependentField({shouldBeRequired:!0,requiredFieldTag:"quartech_cpaconsultant",setRequiredFieldsFunc:setProjectStepRequiredFields}):(shouldRequireDependentField({shouldBeRequired:!1,requiredFieldTag:"quartech_cpaconsultant",setRequiredFieldsFunc:setProjectStepRequiredFields}),$("#quartech_cpaconsultant").off("change"))}))}function setSingleOrGroupApplicant(){if(document.querySelector("#quartech_singleorgroupapplication").value===h){shouldRequireDependentField({shouldBeRequired:!0,requiredFieldTag:"quartech_coapplicatntsnames",setRequiredFieldsFunc:setProjectStepRequiredFields,disableRequiredProp:!0});var e=document.querySelector("#groupApplicationNotice");e?$(e).css({display:""}):addTextAboveField("quartech_coapplicatntsnames",'<div id="groupApplicationNotice" style="padding-bottom: 15px;">\n  If applying for a group project, please ensure all participants submit their own applications and indicate co-applicants as part of the application process.\n</div>')}else{shouldRequireDependentField({shouldBeRequired:!1,requiredFieldTag:"quartech_coapplicatntsnames",setRequiredFieldsFunc:setProjectStepRequiredFields,disableRequiredProp:!0});var t=document.querySelector("#groupApplicationNotice");t&&$(t).css({display:"none"})}}function setupChosen(){Z.info({fn:setupChosen,message:"setting up chosen..."}),$(".chosen-select").chosen(),$(".chosen-select-deselect").chosen({allow_single_deselect:!0});var e=$("#quartech_venuelocationcitytownetcoronlinesoftwar").val();if(e){var t=e.split(", ");$(".chosen-select").val(t),$(".chosen-select").trigger("chosen:updated")}var n=document.getElementById("quartech_venuelocationcitytownetcoronlinesoftwar").closest("tr");new MutationObserver((function(e){var t;"none"===(null==n||null===(t=n.style)||void 0===t?void 0:t.display)&&($(".chosen-select").val([]),$(".chosen-select").trigger("chosen:updated"))})).observe(n,{attributes:!0,attributeFilter:["style"]}),$(".chosen-select").on("change",(function(){setFieldValue("quartech_venuelocationcitytownetcoronlinesoftwar",$(".chosen-select").val().join(", "))})),setupTooltip({name:"quartech_venuelocationcitytownetcoronlinesoftwar",tooltipText:"Project locations in addition to what you have provided in the question above",tooltipTargetElementId:"additionalLocationControl_chosen"}),Z.info({fn:setupChosen,message:"successfully setup chosen..."})}var X=Logger("application/steps/demographicInfo");function setDemographicInfoRequiredFields(){setStepRequiredFields("DemographicInfoStep")}function initOnChange_Question1_SoleProprietorshipOrGeneralPartnership(){var e=$("#quartech_question1reownerproprietorshiporparnership");hideShow_for_Question1_SoleProprietorshipOrGeneralPartnership(e.val()),X.info({fn:initOnChange_Question1_SoleProprietorshipOrGeneralPartnership,message:"initOnChangeQuestion1 called."}),e.on("change",(function(){var e=$(this).val();X.info({fn:initOnChange_Question1_SoleProprietorshipOrGeneralPartnership,message:"Selected Value: ".concat(e)}),hideShow_for_Question1_SoleProprietorshipOrGeneralPartnership(e)}))}function hideShow_for_Question1_SoleProprietorshipOrGeneralPartnership(e){var t="none",n="none",a="none";e===d?(t="block",n="none",a="none",$("#quartech_question2regoverningboard").prop("selectedIndex",0),$("#quartech_question2breorganizationtype").prop("selectedIndex",0),$("#quartech_numberofmembersofthegoverningbody").val(""),$("#quartech_numberofmembersofthegoverningbody").parent().parent().parent().css("display","none"),$("[data-name='Q2c_Section']").parent().css("display","none"),clearQuestion2dAnswers(),$(".msos-selecteditems-container ul li").remove()):e===u?(t="none",n="block",a="block",clearQuestion1abcAnswers()):(clearQuestion1abcAnswers(),$("#quartech_question2regoverningboard").prop("selectedIndex",0),$("#quartech_question2breorganizationtype").prop("selectedIndex",0),$("#quartech_numberofmembersofthegoverningbody").val(""),clearQuestion2dAnswers(),$("#quartech_numberofmembersofthegoverningbody").parent().parent().parent().css("display","none"),$("[data-name='Q2c_Section']").parent().css("display","none"),$(".msos-selecteditems-container ul li").remove()),$("[data-name='Q1a_Section']").parent().css("display",t),$("[data-name='Q1b_Q1c_Section']").parent().css("display",t),$("#quartech_question2breorganizationtype").parent().parent().parent().css("display","none"),$("#quartech_numberofmembersofthegoverningbody").parent().parent().parent().css("display","none"),$("[data-name='Q2_Section']").parent().css("display",n),$("[data-name='Q3_section']").parent().css("display",a),validateDemographicInfoRequiredFields()}function clearQuestion1abcAnswers(){$("#quartech_firstnationssharepercentage").val(""),$("#quartech_inukinuitsharepercentage").val(""),$("#quartech_mtissharepercentage").val(""),$("#quartech_indigenoussharepercentage").val(""),$("#quartech_womensharepercentage").val(""),$("#quartech_youth40orundersharepercentage").val(""),$("#quartech_nonindiginousnonwomennonyouthshare").val(""),$("#quartech_unabletoansweridentifysharepercentage").val(""),$("#quartech_newagricultureentrantssharepercentage").val(""),$("#quartech_declinetoidentifypercentageshares").prop("checked",!1),$("#quartech_percentagesharesownedbynewentrants").val(""),$("#quartech_commentsondemographicsofbusinessowners").val("")}function clearQuestion2dAnswers(){$("#quartech_firstnationsgoverningbodymembers").val(""),$("#quartech_inukinuitgoverningbodymembers").val(""),$("#quartech_mtisgoverningbodymembers").val(""),$("#quartech_indigenousnotspecifiedgoverningbodymember").val(""),$("#quartech_womengoverningbodymembers").val(""),$("#quartech_youthgoverningbodymembers").val(""),$("#quartech_nonindiginousnonwomennonyouthgovbodymbrs").val(""),$("#quartech_question2dgoverningbodymembersunabletoanswer").val(""),$("#quartech_declinetoidentifygoverningbodymember").prop("checked",!1)}function initOnChange_Question2_Re_GoverningBoard(){var e=$("#quartech_question2regoverningboard");hideShow_for_Question2_Re_GoverningBoard(e.val()),X.info({fn:initOnChange_Question2_Re_GoverningBoard,message:"initOnChange_Question2_Re_GoverningBoard called."}),e.on("change",(function(){var e=$(this).val();X.info({fn:initOnChange_Question2_Re_GoverningBoard,message:"Selected Value: ".concat(e)}),hideShow_for_Question2_Re_GoverningBoard(e)}))}function hideShow_for_Question2_Re_GoverningBoard(e){var t="none";e===d?t="table-row":($("#quartech_question2breorganizationtype").prop("selectedIndex",0),$("#quartech_numberofmembersofthegoverningbody").val(""),clearQuestion2dAnswers()),$("#quartech_question2breorganizationtype").parent().parent().parent().css("display",t),$("#quartech_numberofmembersofthegoverningbody").parent().parent().parent().css("display","none"),$("[data-name='Q2c_Section']").parent().css("display","none"),validateDemographicInfoRequiredFields()}function initOnChange_Question2b_Re_OrganizationType(){var e=$("#quartech_question2breorganizationtype");hideShow_for_Question2b_Re_OrganizationType(e.val()),X.info({fn:initOnChange_Question2b_Re_OrganizationType,message:"initOnChange_Question2b_Re_OrganizationType called."}),e.on("change",(function(){var e=$(this).val();X.info({fn:initOnChange_Question2b_Re_OrganizationType,message:"Selected Value: ".concat(e)}),hideShow_for_Question2b_Re_OrganizationType(e)}))}function hideShow_for_Question2b_Re_OrganizationType(e){var t="none",n="none";e===u?(n="block",t="table-row"):clearQuestion2dAnswers(),$("#quartech_numberofmembersofthegoverningbody").parent().parent().parent().css("display",t),$("[data-name='Q2c_Section']").parent().css("display",n),validateDemographicInfoRequiredFields()}function addDemographicInfoChefsIframe(){return _addDemographicInfoChefsIframe.apply(this,arguments)}function _addDemographicInfoChefsIframe(){return(_addDemographicInfoChefsIframe=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(){var e,t,n,a,i,r,o;return _regeneratorRuntime().wrap((function _callee$(c){for(;;)switch(c.prev=c.next){case 0:if(null===(e=$("#quartech_chefssubmissionid"))||void 0===e||null===(e=e.closest("tr"))||void 0===e||e.css({display:"none"}),setFieldReadOnly("quartech_chefsconfirmationid"),n=null===(t=$("#quartech_chefssubmissionid"))||void 0===t?void 0:t.val(),a="",!n){c.next=8;break}a="https://submit.digital.gov.bc.ca/app/form/success?s=".concat(n),c.next=15;break;case 8:return c.next=10,getEnvVars();case 10:i=c.sent,(r=i.quartech_ChefsDemographicDataFormId)||alert("Bad config: Applicant Portal Config should contain the ChefsDemographicDataFormId element"),a="https://submit.digital.gov.bc.ca/app/form/submit?f=".concat(r),window.addEventListener("message",(function(e){if("https://submit.digital.gov.bc.ca"==e.origin&&e.data.indexOf("submissionId")>-1){var t=JSON.parse(e.data);X.info({fn:addDemographicInfoChefsIframe,message:"received submissionId: "+t.submissionId}),$("#quartech_chefssubmissionid").val(t.submissionId),setFieldValue("quartech_chefsconfirmationid",t.submissionId.substring(0,8).toUpperCase())}}));case 15:(o=document.createElement("div")).innerHTML="<iframe id='chefsDemographicInfoIframe' src=\"".concat(a,'" height="800" width="100%" title="Demographic Info in CHEFS">\n      </iframe><br/>'),$("#quartech_chefsconfirmationid_label").parent().parent().prepend(o);case 19:case"end":return c.stop()}}),_callee)})))).apply(this,arguments)}var ee=Logger("application/application");function updatePageForSelectedProgram$1(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;e||(e=getProgramId()),ee.info({fn:updatePageForSelectedProgram$1,message:"Retrieving Program data for the selected programid querystring: ".concat(e)}),getApplicationFormData({programId:e,beforeSend:function beforeSend(){ee.info({fn:updatePageForSelectedProgram$1,message:"clear any cached data from previous page loads"}),localStorage.clear()},onSuccess:function onSuccess(e,t,n){e&&(ee.info({fn:updatePageForSelectedProgram$1,message:"Retrieved Program data:",data:e}),localStorage.setItem("programData",JSON.stringify(e)),ee.info({fn:updatePageForSelectedProgram$1,message:"Update application page with the program data."}),function updateFormStepForSelectedProgram(e){var t;!function populateContentForSelectedProgramStream$1(e){$("#page-title").text(e.quartech_portalapplicationpagetitle),$("#page-subtitle").text(e.quartech_portalapplicationpagesubtitle),$("#page-description").html(e.quartech_portalapplicationpagedescription),$("#quartech_program").val()||function populateProgramLookup(e,t){$("#quartech_program").val(e),$("#quartech_program_name").val(t),$("#quartech_program_entityname").val("msgov_program")}(e.msgov_programid,e.msgov_programname)}(e);var n=getProgramAbbreviation();switch(n&&"NEFBA"===n?($("div[id*='ProgressIndicator'] li:contains('Deliverables & Budget')").css("display","none"),$("div[id*='ProgressIndicator'] li:contains('Documents')").css("display","none")):n&&n.includes("KTTP")&&($("div[id*='ProgressIndicator'] li:contains('Documents')").css("display","none"),$("div[id*='ProgressIndicator'] li:contains('Eligibility')").css("display","none")),getCurrentStep()){case l.ApplicantInfo:!function customizeApplicantInfoStep(e){!function setupApplicantInfoStepFields(){setStepRequiredFields("ApplicantInfoStep");var e=getProgramAbbreviation();e&&"NEFBA"===e&&(initOnChange_DependentRequiredField({dependentOnValue:"255550001",dependentOnElementTag:"quartech_fillingfarmingincomeontaxreturn",requiredFieldTag:"quartech_firstyearclaimedfarmingincome",validationFunc:validateStepFields}),initOnChange_DependentRequiredField({dependentOnValue:"255550000",dependentOnElementTag:"quartech_fillingfarmingincomeontaxreturn",requiredFieldTag:"quartech_firstyearfarmoperationgeneratingrevenue",validationFunc:validateStepFields})),e&&e.includes("ABPP")&&(document.querySelector("#tipReportNotice")||addTextBelowField("quartech_tipreportenrolled",'<div id="tipReportNotice" style="padding-top: 50px;">\n      The TIP report is a free, simplified cash-basis farm financial analysis, which provides you with a cost of production (COP) report to compare your own farms current year (income and expenses) to your previous 5-year average and to benchmarks with other farms of similar type and income range: <a style="color:blue" href="https://www2.gov.bc.ca/gov/content/industry/agriculture-seafood/business-market-development/agrifood-business-management/running-a-farm-business/towards-increased-profits-report">Towards Increased Profits (TIP) report - Province of British Columbia (gov.bc.ca)</a>.\n      </div>'),initOnChange_DependentRequiredField({dependentOnValue:"255550001",dependentOnElementTag:"quartech_agriprogramsubscriber",requiredFieldTag:"quartech_tipreportenrolled",customFunc:setShowOrHideTipNotice}),setShowOrHideTipNotice()),e&&(e.includes("ABPP")||"NEFBA"===e)&&(addTextAboveField("quartech_indigenousapplicant","<div>The Province is committed to supporting the success of Indigenous businesses in the agriculture and food sector. We understand that Indigenous businesses may have distinct characteristics reflecting regulatory, operational, cultural, and other factors. We aim for flexibility in our program delivery to reduce barriers and ensure the accessibility of our programs. If you are interested in applying to the Program but have questions about the application process or eligibility criteria, please contact Program staff at Agribusiness@gov.bc.ca<br /><br /></div>"),initOnChange_DependentRequiredField({dependentOnValue:"255550001",dependentOnElementTag:"quartech_recipienttype",requiredFieldTag:"quartech_commodity",validationFunc:validateStepFields}),initOnChange_DependentRequiredField({dependentOnValue:"255550001",dependentOnElementTag:"quartech_recipienttype",requiredFieldTag:"quartech_othercommoditiesproducedharvested",disableRequiredProp:!0,validationFunc:validateStepFields}),initOnChange_DependentRequiredField({dependentOnValue:"255550002",dependentOnElementTag:"quartech_recipienttype",requiredFieldTag:"quartech_primarilyprocess",validationFunc:validateStepFields}),initOnChange_DependentRequiredField({dependentOnValue:"255550002",dependentOnElementTag:"quartech_recipienttype",requiredFieldTag:"quartech_otherproductsprocessed",disableRequiredProp:!0,validationFunc:validateStepFields})),$("#quartech_recipienttype").on("change",(function(){$("#quartech_commodity_name").val(""),$("#quartech_primarilyprocess_name").val(""),$("#quartech_othercommoditiesproducedharvested_i .msos-selecteditems-container ul li").remove(),$("#quartech_otherproductsprocessed_i .msos-selecteditems-container ul li").remove()}))}(),initOnChange_PreviouslyReceivedKttpFunding(),initOnChange_OrganizationReceivedFundingFromBC(),initOnChange_IsCollaboratingWithOtherOrganizationQuestion(),initOnChange_ActivityOverMultipleDays(),initOnChange_AdaptedEventForAdultLearning(),function handleApplicantWithAndWithoutCRA_GST(){showHideForApplicantWithAndWithoutCRA_GST($("#quartech_nocragstnumber").prop("checked")),$("#quartech_nocragstnumber").on("change",(function(){showHideForApplicantWithAndWithoutCRA_GST($(this).prop("checked"))}))}(),function initOrgNameAutocomplete(){var e=document.querySelector("#quartech_legalbusinessororganizationname");e&&$(e).autocomplete({source:function source(e,t){getOrgbookAutocompleteData({searchStr:e.term,onSuccess:function onSuccess(e){var n=e.total?e.results:[];t(n)}})},minLength:2,select:function select(e,t){$("#quartech_nocragstnumber").prop("checked")||getTopic(t.item)}})}(),function customizeTypesOfBusinessOrganization(e){var t;(function hideTypesOfBusinessOrganization(e){if(e){var t=JSON.parse(e);t&&$("#quartech_recipienttype option").each((function(){var e=this.value;""!=e&&null==t[e]&&(this.hidden=!0)}))}})(e.quartech_typesofbusinesstodisplay),function addTooltipsToTypesOfBusinessOrganization(e){if(e){var t=JSON.parse(e),n=null==t?void 0:t.TypeOfBusiness_ToolTips;n&&$("#quartech_recipienttype option").each((function(){var e=this.value,t=n[e];t&&(this.title=t.Tooltip)}))}}(null==e||null===(t=e.quartech_ApplicantPortalConfig)||void 0===t?void 0:t.quartech_configdata)}(e),getProgramAbbreviation().includes("ABPP")&&function customizeApplicantInfoStepForABPP(e){addTextAboveField("quartech_businessdescription",'<div style="padding-bottom: 15px;">\n    <div>Please provide a brief description of your business e.g.,</div>\n    <ul>\n      <li>For Primary Producer - farm size in production in units such as acres, metres squared, and number and type of animals, marketing channels (farm gate, wholesale, retail/use of social media)</li>\n      <li>OR For Processor - size of processing area in units such as square feet or metres, number and type of B.C. products used and/or produced, marketing channels (direct, wholesale, retail/use of social media)</li>\n    </ul>\n  </div>')}(),"NEFBA"===getProgramAbbreviation()&&function customizeApplicantInfoStepForNEFBA(){var e=$('fieldset[aria-label="Business Overview"]');e&&e.css("display","none")}()}(e);break;case l.Eligibility:!function customizeEligibilityStep(e){!function setupEligibilityStepFields(){setStepRequiredFields("EligibilityStep");var e=getProgramAbbreviation();if(e&&(e.includes("ABPP")||"NEFBA"===e)){var t="";"ABPP1"===e?t="quartech_primaryproducer100or51percent":"ABPP2"===e?t="quartech_farmbusinesscapacityevaluationriskplan":"NEFBA"===e&&(t="quartech_isaprimaryproducergrowingsellingproducts"),addTextAboveField(t,"<b>Please answer the following questions to confirm your eligibility for the program.</b><br/> Note that applicants may be audited and must be able to demonstrate the validity of information provided in this application form.<br /><br />")}e&&e.includes("ABPP")&&(initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_abppsupportoverlimit",requiredFieldTag:"quartech_abppsupportoverlimitdetail"}),initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_supportreceivedduringscap",requiredFieldTag:"quartech_supportduringscapdetails"})),e&&"NEFBA"===e&&initOnChange_DependentRequiredField({dependentOnValue:"255550001",dependentOnElementTag:"quartech_bcregisteredbusinessentity",requiredFieldTag:"quartech_committedbizregistrationbeforecompletion",validationFunc:validateStepFields})}()}();break;case l.Project:!function customizeProjectStep(e){setProjectStepRequiredFields(),function setProjectStepDependentRequiredFields(){var e,t=getProgramAbbreviation();t.includes("KTTP")&&(initOnChange_DependentRequiredField({dependentOnValue:g,dependentOnElementTag:"quartech_naicsindustry",requiredFieldTag:"quartech_ifotherpleasedescribecommodity"}),initOnChange_DependentRequiredField({dependentOnValueArray:["255550001","255550002"],dependentOnElementTag:"quartech_eventtype",requiredFieldTag:"quartech_projectlocation"}),initOnChange_DependentRequiredField({dependentOnValue:"255550001",dependentOnElementTag:"quartech_projecttakesplaceinotherplaces",requiredFieldTag:"quartech_venuelocationcitytownetcoronlinesoftwar"})),"ABPP2"===t&&(initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_useofsupportingconsultant",requiredFieldTag:"quartech_consultantcompletingoverlimit"}),initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_useofsupportingconsultant",requiredFieldTag:"quartech_supportingconsultantcompanyname"}),initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_useofsupportingconsultant",requiredFieldTag:"quartech_supportingconsultantfullname"}),initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_useofsupportingconsultant",requiredFieldTag:"quartech_supportingconsultantpositiontitle"}),initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_useofsupportingconsultant",requiredFieldTag:"quartech_supportingconsultantrationale"}),setSingleOrGroupApplicant(),document.querySelector("#quartech_singleorgroupapplication")&&function setSingleOrGroupApplicantOnChange(){$("#quartech_singleorgroupapplication").on("change",(function(){setSingleOrGroupApplicant()}))}());var n=document.querySelector("#quartech_inordertocontinuouslyimprovecommunications_i");(null===(e=document.querySelector("#quartech_inordertocontinuouslyimprovecommunications_i"))||void 0===e?void 0:e.querySelector('li[aria-label="Other for In order to continuously improve communications"]'))?initOnChange_DependentRequiredField({dependentOnElementTag:"quartech_inordertocontinuouslyimprovecommunications_i",overrideTruthyClause:!0,requiredFieldTag:"quartech_ifotherpleasedescribe"}):initOnChange_DependentRequiredField({dependentOnElementTag:"quartech_inordertocontinuouslyimprovecommunications_i",overrideTruthyClause:!1,requiredFieldTag:"quartech_ifotherpleasedescribe"}),new MutationObserver((function(e){var t;null!==(t=document.querySelector("#quartech_inordertocontinuouslyimprovecommunications_i"))&&void 0!==t&&t.querySelector('li[aria-label="Other for In order to continuously improve communications"]')?$("#quartech_ifotherpleasedescribe_label").is(":visible")||initOnChange_DependentRequiredField({dependentOnElementTag:"quartech_inordertocontinuouslyimprovecommunications_i",overrideTruthyClause:!0,requiredFieldTag:"quartech_ifotherpleasedescribe"}):initOnChange_DependentRequiredField({dependentOnElementTag:"quartech_inordertocontinuouslyimprovecommunications_i",overrideTruthyClause:!1,requiredFieldTag:"quartech_ifotherpleasedescribe"})})).observe(n,{attributes:!0,childList:!0,characterData:!0})}(),function displayLabelsForProjectStep(e){var t,n,a=JSON.parse(e.quartech_portalappfieldsdisplaynamesmapping);if(a)for(var i=0,r=Object.entries(a);i<r.length;i++){var o=(n=2,function _arrayWithHoles(e){if(Array.isArray(e))return e}(t=r[i])||function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r,o,c=[],l=!0,s=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=r.call(n)).done)&&(c.push(a.value),c.length!==t);l=!0);}catch(e){s=!0,i=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw i}}return c}}(t,n)||_unsupportedIterableToArray(t,n)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=o[0],l=o[1],s=$("#".concat(c,"_label"));s&&s.text(l)}}(e),function customizeActivityTypesDropDownList(e){!function hideActivityTypes(e){if(e){var t=JSON.parse(e);t&&$("#quartech_pleaseselectthemostapplicableactivitytype option").each((function(){var e=this.value;""!=e&&null==t[e]&&(this.hidden=!0)}))}}(e.quartech_activitiestypestodisplay)}(e),initOnChange_ActiviyOpenToPublic(),function initAdditionalLocationsMultiSelect(){getMunicipalData({onSuccess:function onSuccess(e){e&&function addLocationMultiSelect(e){var t,n="quartech_venuelocationcitytownetcoronlinesoftwar";if($("#".concat(n))){var a=processLocationData(e),i=$("#".concat(n)).closest("div");null===(t=$(i))||void 0===t||t.append('\n      <select id="additionalLocationControl" data-placeholder="Select locations" class="chosen-select" multiple tabindex="6">\n        <option value=""></option>\n      </select>\n    '),$("#".concat(n)).css({display:"none"}),Object.keys(a).forEach((function(e){var t=$('<optgroup label="'+e+'" />');a[e].forEach((function(e){$('<option value="'.concat(e,'"/>')).html(e).appendTo(t)})),t.appendTo($("#additionalLocationControl"))})),useScript("chosen",setupChosen)}}(e)}})}()}(e);break;case l.DeliverablesBudget:!function customizeDeliverablesBudgetStep(){var e=getProgramAbbreviation();setStepRequiredFields("DeliverablesBudgetStep");var t=document.querySelector("#EntityFormView > h2");if(t&&t.textContent.includes("Deliverables & Budget")&&$(t).css("display","none"),e&&e.includes("KTTP")){!function customizeEstimatedActivityBudgetStepForKTTP(){(function addEstimatedActivityBudgetDescription(){var e=document.createElement("div");e.innerHTML='<p>Please provide an estimated budget</p><p><b><i>A detailed itemized list of expenses, invoice, event report, and reimbursement form must be submitted within 30 days post-activity. All invoices for eligible activity costs incurred and proof of payment of goods and receipts should be kept for seven years as there is a chance you may be audited.</i></b></p><p><span style="color:red">*</span> <span>required field</span></p>',$("[data-name='tab_Estimated_Activity_Budget']").parent().prepend(e)})(),function setupEstimatedActivityBudget(){(function initialDeliverablesBudgetSingleRowSetup(){var e=$('table[data-name="tab_DeliverablesBudget_section_General"]');e.find("colgroup").remove(),e.find('tbody > tr > td[colspan="1"]').each((function(){$(this).attr("colspan","2")}))})(),combineElementsIntoOneRow("quartech_smetravelairfareparkingetc","quartech_pleasedescribemodeoftravelifapplicable"),combineElementsIntoOneRow("quartech_smeaccommodation","quartech_pleasedescribeaccommodationwherewillthesme"),combineElementsIntoOneRow("quartech_facilityequipmenttechnologyrental","quartech_pleasedescribeequipmentrequiredifapplicable"),combineElementsIntoOneRow("quartech_advertisingcommunications","quartech_pleasedescribewhatformsofadvertisingcommunic"),combineElementsIntoOneRow("quartech_administrationcosts","quartech_pleasedescribetheadministrativecoststobeinc"),combineElementsIntoOneRow("quartech_othercost","quartech_pleaseexplainotherifapplicable"),combineElementsIntoOneRow("quartech_costsharecontributioncashorinkinddonation","quartech_pleaseexplainwhotheotherpartnersareandwha")}(),calculateEstimatedActivityBudget()}(),setOnKeypressBudgetInput("quartech_smefee"),setOnKeypressBudgetInput("quartech_smetravelairfareparkingetc"),setOnKeypressBudgetInput("quartech_smeaccommodation"),setOnKeypressBudgetInput("quartech_facilityequipmenttechnologyrental"),setOnKeypressBudgetInput("quartech_advertisingcommunications"),setOnKeypressBudgetInput("quartech_administrationcosts"),setOnKeypressBudgetInput("quartech_othercost"),setOnKeypressBudgetInput("quartech_costsharecontributioncashorinkinddonation");var n=document.querySelector("#EntityFormView > div.tab.clearfix > div > div > fieldset:nth-child(1) > legend > h3");n.textContent.includes("Deliverables & Budget")&&(n.textContent="Estimated Activity Budget"),$("#quartech_estimatedbudgettotalactivitycost").prop("readonly",!0),$("#quartech_estimatedbudgettotalactivitycost").off("change"),$("#quartech_estimatedbudgettotalactivitycost").off("input"),$("#quartech_estimatedbudgettotalactivitycost").off("keypress"),$("#quartech_estimatedbudgettotalactivitycost").attr("style","background-color: #eee !important"),document.querySelector("#costShareContributionNote")||addTextAboveField("quartech_totalfundingrequiredfromtheprogram",'<div id="costShareContributionNote" style="padding-bottom: 50px;">\n      All applicants are expected to provide a minimal cost-shared amount of 25% for ELIGIBLE EXPENSES ONLY. Cash and in-kind can include the organization\'s own contributions and/or contributions from other sponsoring partners. The Province reserves the right to waive the cost-shared requirement for groups who may face barriers to the program including groups supporting or run by underserved populations. Please provide the total dollar amount (including in-kind). You will be asked to show the contribution when submitting reimbursement request. A list of eligible and ineligible expenses are provided in the Program Guide.\n      </div>'),$("#quartech_totalfundingrequiredfromtheprogram").prop("readonly",!0),$("#quartech_totalfundingrequiredfromtheprogram").off("change"),$("#quartech_totalfundingrequiredfromtheprogram").off("input"),$("#quartech_totalfundingrequiredfromtheprogram").off("keypress"),$("#quartech_totalfundingrequiredfromtheprogram").attr("style","background-color: #eee !important")}setStepRequiredFields("DeliverablesBudgetStep")}();break;case l.Documents:!function customizeDocumentsStep$1(){var e=getProgramAbbreviation();if(e&&e.includes("ABPP")){var t;t="ABPP1"===e?'<div><div>Please Choose or Drag &amp; Drop files to the grey box below to upload the following documents as attachments (as applicable)</div><ul><li>Event/training budget (if not outlined in Deliverables & Budget tab)</li><li>Verification of the last year of farming income (T2042, T1273, or Schedule 125  Farm Revenue) detailing sales by commodity revenue code) or business income if applying as a food processor</li><li>Direct Deposit Application (template available on program webpage)</li></ul><div>Please ensure you have the correct files before clicking Next on the application. If you move to the next stage of the application you can no longer delete uploaded files. However, you can always add new files.</div><div>If you have moved to the next stage and then wish to change an uploaded file, simply return to the document submission and upload the replacement file as an additional file. Give the file a name with an indication that it is a replacement (e.g. "Budget NEW.xls").</div></div>':'<div><div>Please Choose or Drag &amp; Drop files to the grey box below to upload the following documents as attachments (as applicable)</div><ul><li>Project budget</li><li title="Consultant resume outlining any educational accomplishments and relevant certifications">Consultant resume</li><li>Supporting consultant resume (if applicable)</li><li>Verification of the last year of farming income</li><li>Direct Deposit Application (template available on program webpage)</li></ul><div>Please ensure you have the correct files before clicking Next on the application. If you move to the next stage of the application you can no longer delete uploaded files. However, you can always add new files.</div><div>If you have moved to the next stage and then wish to change an uploaded file, simply return to the document submission and upload the replacement file as an additional file. Give the file a name with an indication that it is a replacement (e.g. "Budget NEW.xls").</div></div>';var n=document.querySelector("#EntityFormView > div.tr > div > div.control > div");$(n).replaceWith(t)}}();break;case l.DemographicInfo:!function customizeDemographicInfoStep(e){null!=e&&e.quartech_disabledchefsdemographicinfo?(function hideChefsIntegration(){$("[data-name='DemographicInfoChefsSubmissionSection']").parent().css("display","none")}(),function addDemographicDataDescriptionOldVersionForABPP(){var e=document.createElement("div"),t=function getProgramEmailAddress(){var e;const t=localStorage.getItem("programData");return null===(e=JSON.parse(t))||void 0===e?void 0:e.quartech_programemailaddress}();e.innerHTML="<p>The Province of British Columbia supports inclusive and increased representation of underrepresented groups. By providing the information below, you are helping to improve the delivery of programming. At this time, the questions focus on three identity groups, and do not cover all potential groups who are underrepresented in the agriculture sector. We plan to expand the focus to other underrepresented groups in future.</p>"+'<p>Your personal information is collected under section 26(c) and 26(e) of the Freedom of Information and Protection of Privacy Act for the purposes of evaluating applications and for the planning and evaluating of the S-CAP Ministry Program. The demographic information you provide is voluntary and will not be used to assess your eligibility for this program. Each individual understands the purposes of the collection, use, and disclosure of their demographic personal information. The information you provide will be shared with the federal government to fulfill the provincial obligations under the Sustainable Canadian Agricultural Partnership (S-CAP) bilateral agreement. It may be combined with other survey or administrative data sources and used for statistical, research and evaluation purposes. If any information is published, your responses will be combined with the responses of others so that you cannot be identified. If you have any questions about the collection of your information, please contact the program manager at <a href = "mailto: '.concat(t,'">').concat(t,"</a>.</p>")+'<p><span>Required Field </span><span style="color:red">*</span></p>',$("[data-name='DemographicData_Tab1']").parent().prepend(e)}(),setDemographicInfoRequiredFields(),function addViewExampleTo_Q1a(){var e=document.createElement("div");e.innerHTML='\n    <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">\n      <div class="panel panel-default">\n        <div class="panel-heading" role="tab" id="headingOne">\n          <h4 class="panel-title">\n          <a role="button" class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="false" aria-controls="collapseOne">\n              View Example\n          </a>\n          </h4>\n        </div>\n        <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">\n          <div class="panel-body">\n            <i>As an example, a company has 4 owners:\n            <br/>  1 owner identifies as First Nation and a woman and owns 10% of the business.\n            <br/>  1 owner identifies as a youth (40 or younger) and as Indigenous but the applicant is not aware of which specific Indigenous group this owner identifies with. This owner owns 50% of the business.\n            <br/>  2 identify as non-Indigenous men over 40 and each owns 10% of the business.\n            <br/>  In this case, you would enter 10% for \'First Nations\', 10% for \'women\', 50% for \'youth\', 50% for \'Indigenous - not specified\', and 20% for \'none of the above groups\'. The numbers could add up to more than 100% - that\'s fine!\n            </i>\n          </div>\n        </div>\n      </div>\n    </div>\n  ',$("[data-name='Q1a_Section']").parent().prepend(e)}(),initOnChange_Question1_SoleProprietorshipOrGeneralPartnership(),initOnChange_Question2_Re_GoverningBoard(),initOnChange_Question2b_Re_OrganizationType(),function initOnChange_Question4_DoesYourOrganizationTargetAnyGroups(){var e,t="#quartech_doesyourorganizationtargetanyofthegroups_Container",n=$(t).find(".msos-option"),a=$(t).find("li>>input.msos-checkbox"),i=null===(e=n.filter((function(e){return n[e].innerText.includes("None")})))||void 0===e?void 0:e[0];$(i).on("click",(function(){var e=a.filter((function(e){return a[e].checked&&!a[e].ariaLabel.includes("None")}));e.length>0&&e.trigger("change",!1)}));var r=n.filter((function(e){return!n[e].innerText.includes("None")}));$(r).on("click",(function(){var e=a.filter((function(e){return a[e].checked&&a[e].ariaLabel.includes("None")}));e.length>0&&e.trigger("change",!1)}))}(),function addDemographicInfoPercentageColumnTitle(){$("#EntityFormView > div.tab.clearfix > div > div > fieldset:nth-child(3) > table > tbody").prepend('<tr><td colspan="1" rowspan="1" class="clearfix cell decimal form-control-cell"><div class="info"><label for="quartech_firstnationssharepercentage" id="quartech_firstnationssharepercentage_label" class="field-label"></label><div class="validators"><span id="FloatValidatorquartech_firstnationssharepercentage" style="visibility:hidden;">*</span><span id="RangeValidatorquartech_firstnationssharepercentage" style="visibility:hidden;">*</span></div></div><div class="control" style="width: 25% !important">Percentage of business shares owned</div></td><td class="cell zero-cell"></td></tr>')}()):(setDemographicInfoRequiredFields(),function showChefsIntegration(){(function addDemographicDataDescription(){var e=document.createElement("div");e.innerHTML="<h3>Demographic Data Collection</h3>\n    <p>The Province of British Columbia supports inclusive and increased representation of underrepresented groups. By participating in the survey below, you are helping to improve the delivery of programming. At this time, the questions focus on three identity groups (Indigenous, women and youth), and do not cover all potential groups who are underrepresented in the agriculture sector. We plan to expand the focus to other underrepresented groups in future.</p>\n    <p>The survey is conducted independently of the funding program to which you are applying, and your survey responses will not be included in your funding application. If you wish to save a copy of your survey responses, you will have the option of emailing it to yourself upon completion. Please see the top of the survey form for instructions on how to receive a copy by email.</p>",$("[data-name='DemographicData_Tab1']").parent().prepend(e)})(),function hideAllStepSections(){$("fieldset > table").parent().css("display","none")}(),$("[data-name='DemographicInfoChefsSubmissionSection']").parent().css("display","block"),addDemographicInfoChefsIframe()}())}(e);break;case l.DeclarationAndConsent:!function customizeDeclarationConsentStep$1(e){hideFieldsAndSections(!1),function addConsent$1(e){var t="<div style='font-style: italic;'>\n      <span>BY SUBMITTING THIS APPLICATION FORM TO %%ProgramName%% (the \"Program\"), I:</span>\n      <u style='text-decoration:none;'>\n          <li>represent that I am the applicant or the fully authorized signatory of the applicant;</li>\n          <li>\n              declare that I have/the applicant has not knowingly submitted false or misleading information and that the information provided in this application and attachments is true and correct in every respect to the best of my/the applicant's knowledge;</li>\n          <li>acknowledge the information provided on this application form and attachments will be used by the Ministry of Agriculture and Food (the \"Ministry\") to assess the applicant's eligibility for funding from the Program;</li>\n          <li>understand that failing to comply with all application requirements may delay the processing of this application or make the applicant ineligible to receive funding under the Program;</li>\n          <li>represent that I have/the applicant has read and understood the Program Terms and Conditions and agree(s) to be bound by the Program Terms and Conditions;</li>\n          <li>represent that the applicant is in compliance with all Program eligibility requirements as described in the Program Terms and Conditions, and in this document;</li>\n          <li>agree to proactively disclose to the Program all other sources of funding the applicant or any partners within the same organization or the same farming or food processing operation receives with respect to the projects funded by this Program, including financial and/or in-kind contributions from federal, provincial, or municipal government;</li>        \n          <li>acknowledge that the Business Number (GST Number) is collected by the Ministry under the authority of the Income Tax Act for the purpose of reporting income.</li>\n      </u>\n      <br/>\n  </div>";t=t.replace("%%ProgramName%%",e);var n=document.createElement("div");n.innerHTML=t,$("[data-name='tab_ApplicationDeclarationandConsent']").parent().prepend(n)}(null==e?void 0:e.quartech_applicantportalprogramname)}(e)}!function updateFieldsHintTextsByConfigData(e){if(e){var t=JSON.parse(e),n=null==t?void 0:t.FieldsHintTexts;if(n)switch(getCurrentStep()){case l.ApplicantInfo:updateFieldsHintTexts(n.ForApplicantInfoStep);break;case l.Project:updateFieldsHintTexts(n.ForProjectStep);break;case l.EstimatedActivityBudget:updateFieldsHintTexts(n.ForEstimatedActivityBudgetStep);break;case l.DemographicInfo:updateFieldsHintTexts(n.ForDemographicInfoStep);break;case l.DeclarationAndConsent:updateFieldsHintTexts(n.ForDeclarationAndConsentStep)}}}(null==e||null===(t=e.quartech_ApplicantPortalConfig)||void 0===t?void 0:t.quartech_configdata)}(e),hideLoadingAnimation(),validateRequiredFields())}})}function updateFieldsHintTexts(e){e&&e.forEach((function(e,t){var n=null==e?void 0:e.FieldName,a=null==e?void 0:e.HintText;n&&a&&$("#".concat(n)).attr("placeholder",a)}))}function customizeSingleOrGroupApplicantQuestions(e){var t=document.querySelector('fieldset[aria-label="Coding Section (DO NOT REMOVE)"] iframe'),n=null!=t&&t.contentDocument?t.contentDocument:t.contentWindow.document,a=null==n?void 0:n.getElementById("quartech_singleorgroupapplication");a&&(null==a?void 0:a.value)!==h&&hideQuestion(e)}function customizeBusinessPlanDependentQuestions(){if(!document.querySelector("#claimInformationNote")){var e=document.querySelector('fieldset[aria-label="Coding Section (DO NOT REMOVE)"] iframe'),t=null!=e&&e.contentDocument?e.contentDocument:e.contentWindow.document,n=null==t?void 0:t.getElementById("quartech_completingcategory");n&&("255550000"===(null==n?void 0:n.value)?document.querySelector("#claimInformationNote")||$('fieldset[aria-label="Claim Information"] > legend').after('<div id="claimInformationNote" style="padding-bottom: 20px;">\n        The Reimbursement Amount Requested should be the same as your approved Authorization Letter.</div>'):"255550001"!==(null==n?void 0:n.value)||document.querySelector("#claimInformationNote")||$('fieldset[aria-label="Claim Information"] > legend').after('<div id="claimInformationNote" style="padding-bottom: 20px;">\n        The Reimbursement Amount Requested should be the same as your approved Authorization Letter.<br />\n        <br />\n        The Program requires paid invoice(s) from the Consultant and proof of payment such as a cancelled cheque(s) or credit card transaction receipt(s).</div>'))}}function customizeBusinessPlanDocumentsQuestions(){var e=document.querySelector('fieldset[aria-label="Coding Section (DO NOT REMOVE)"] iframe'),t=null!=e&&e.contentDocument?e.contentDocument:e.contentWindow.document,n=null==t?void 0:t.getElementById("quartech_completingcategory");n&&"255550000"===(null==n?void 0:n.value)&&(hideQuestion("quartech_invoices"),hideQuestion("quartech_proofofpayment"))}var te=Logger("claim/claim");function updatePageForSelectedProgram(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;e||(e=getProgramId()),te.info({fn:updatePageForSelectedProgram,message:"Retrieving Program data for the selected programid querystring: ".concat(e)}),getClaimFormData({programId:e,beforeSend:function beforeSend(){te.info({fn:updatePageForSelectedProgram,message:"clear any cached data from previous page loads"}),localStorage.clear()},onSuccess:function onSuccess(e,t,n){e&&(te.info({fn:updatePageForSelectedProgram,message:"Retrieved Program data:",data:e}),localStorage.setItem("programData",JSON.stringify(e)),te.info({fn:updatePageForSelectedProgram,message:"Update application page with the program data."}),function populateContentForSelectedProgramStream(e){var t,n,a,i,r;null===(t=document.querySelector("#page-title-container > p:nth-child(5)"))||void 0===t||t.remove(),null===(n=document.querySelector("#page-title"))||void 0===n||n.remove(),null===(a=document.querySelector("#page-subtitle"))||void 0===a||a.remove(),null===(i=document.querySelector("#page-title-container > p.smallText"))||void 0===i||i.remove(),null===(r=document.querySelector("#page-description"))||void 0===r||r.remove(),$("#page-title-container").prepend(e.quartech_claimformheaderhtmlcontent),function updateClaimFormStepForSelectedProgram(e){var t=getCurrentStep();switch(t){case l.ClaimInfo:!function customizeClaimInfoStep(){setStepRequiredFields("ClaimInfoStep");var e=getProgramAbbreviation();function addRequestedClaimAmountNote(){document.querySelector("#requestedClaimAmountNote")||$("#quartech_totalfees").closest("tr").before('<div id="requestedClaimAmountNote" style="padding-bottom: 20px;">\n        The Program covers costs up to the maximum amount indicated in your Approval Letter.<br />\n        Any additional fees invoiced will not be covered by the B.C. Ministry of Agriculture and Food\n      </div>')}function addClaimAmountCaveatNote(){var e;if("255550000"===$("#quartech_interimorfinalpayment").val())if(document.querySelector("#claimAmountCaveatNote")){var t;null===(t=$("#claimAmountCaveatNote"))||void 0===t||t.css({display:""})}else $("#requestedClaimAmountNote").after("\n          <div id='claimAmountCaveatNote' style=\"padding-bottom: 20px;\">\n            The requested amount must fall within the range of $500.00 to the authorized amount specified on the Authorization Letter.\n          </div>\n        ");else null===(e=$("#claimAmountCaveatNote"))||void 0===e||e.css({display:"none"})}if("NEFBA"===e&&(initOnChange_DependentRequiredField({dependentOnValue:u,dependentOnElementTag:"quartech_applicantinformationconfirmation",requiredFieldTag:"quartech_applicantinformationcorrections"}),addRequestedClaimAmountNote(),observeIframeChanges(customizeBusinessPlanDependentQuestions,null,"quartech_completingcategory")),e.includes("ABPP")){initOnChange_DependentRequiredField({dependentOnValue:u,dependentOnElementTag:"quartech_applicantinformationconfirmation",requiredFieldTag:"quartech_applicantinformationcorrections"});var t=document.querySelector('fieldset[aria-label="Coding Section (DO NOT REMOVE)"] iframe'),n=(t.contentDocument?t.contentDocument:t.contentWindow.document).getElementById("quartech_singleorgroupapplication");n&&(null==n?void 0:n.value)!==h&&hideQuestion("quartech_claimcoapplicants"),addRequestedClaimAmountNote(),addClaimAmountCaveatNote(),$('select[id*="quartech_interimorfinalpayment"]').on("change",(function(){addClaimAmountCaveatNote()}))}"ABPP1"===e?document.querySelector("#claimInformationNote")||$('fieldset[aria-label="Claim Information"] > legend').after('<div id="claimInformationNote" style="padding-bottom: 20px;">\n        The Program requires paid invoice(s) from the Learning Provider(s), and proof of payment such as a cancelled cheque(s) or credit card transaction receipt(s).<br />\n        <br />\n        The Reimbursement Amount Requested for specialized training  should be the same as your approved Learning Action Plan  and Authorization Letter.<br />\n        <br />\n        Reimbursement Amount Requested includes registration fees (such as training, courses, registration, tuition) GST and total.</div>'):"ABPP2"===e&&(document.querySelector("#claimInformationNote")||$('fieldset[aria-label="Claim Information"] > legend').after('<div id="claimInformationNote" style="padding-bottom: 20px;">\n        The Program requires paid invoice(s) from the Consultant and proof of payment such as a cancelled cheque(s) or credit card transaction receipt(s).<br />\n        <br />\n        The Reimbursement Amount Requested should be the same as your approved Authorization Letter.<br />\n        <br />\n        Reimbursement Amount Requested includes Consultant Fee, GST, and total.</div>'),observeChanges($("#quartech_requestedinterimpaymentamount")[0],function customizeInterimPaymentAmountField(){var e,t=null===(e=$("#quartech_requestedinterimpaymentamount"))||void 0===e?void 0:e.val(),n=parseFloat(t.replace(/,/g,""));isNaN(n)&&(n=0),n>0?(setFieldReadOnly("quartech_requestedinterimpaymentamount"),setFieldReadOnly("quartech_interimorfinalpayment")):hideQuestion("quartech_requestedinterimpaymentamount")}()),observeIframeChanges(customizeSingleOrGroupApplicantQuestions,"quartech_claimcoapplicants","quartech_singleorgroupapplication"))}();break;case l.ProjectIndicators:!function customizeProjectIndicatorStep(e){setStepRequiredFields(e);var t=getProgramAbbreviation();(t.includes("ABPP")||"NEFBA"===t)&&(initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_adoptedprojectresults",requiredFieldTag:"quartech_adoptednumber"}),initOnChange_DependentRequiredField({dependentOnValue:d,dependentOnElementTag:"quartech_environmentallybeneficialadoptedresults",requiredFieldTag:"quartech_environmentallybeneficialadoptednumber"})),"ABPP2"===t&&observeIframeChanges(customizeSingleOrGroupApplicantQuestions,"quartech_groupprojectsupportingsectorcapacitybuilding","quartech_singleorgroupapplication")}(t);break;case l.Documents:!function customizeDocumentsStep(e){setStepRequiredFields(e);var t=getProgramAbbreviation();"NEFBA"===t&&observeIframeChanges(customizeBusinessPlanDocumentsQuestions,null,"quartech_completingcategory"),(t.includes("ABPP")||"NEFBA"===t)&&(document.querySelector("#supportingDocumentationNote")||$('fieldset[aria-label="Supporting Documents"] > legend').after('\n      <div id="supportingDocumentationNote" style="padding-bottom: 20px;">\n        Please Choose or Drag & Drop files to the grey box below to upload the following documents as attachments (as applicable)\n      </div>'),document.querySelector("#beforeContinuingNote")||$("#EntityFormView").after('\n        <div id="beforeContinuingNote" style="padding-bottom: 20px;">\n          Please ensure you have the correct files before clicking Next. If you move to the next stage of the Claim for Payment form you can no longer delete uploaded files. However, you can always add new files.<br />\n          <br />\n          If you have moved to the next stage and then wish to change an uploaded file, simply return to the document submission and upload the replacement file as an additional file. Give the file a name with an indication that it is a replacement (e.g. "Budget NEW.xls").\n        </div>\n      '))}(t);break;case l.Consent:!function customizeDeclarationConsentStep(e){hideFieldsAndSections(!1),function addConsent(e){var t="\n    <div style='font-style: italic;'>\n      <span>BY SUBMITTING THIS CLAIM FOR PAYMENT FORM TO %%ProgramName%% (the \"Program\"), I:</span>\n      <u style='text-decoration:none;'>\n          <li>represent that I am the applicant or the fully authorized signatory of the applicant;</li>\n          <li>declare that I have/the applicant has not knowingly submitted false or misleading information and that the information provided in this claim for payment form and attachments is true and correct in every respect to the best of my/the applicant's knowledge;</li>\n          <li>acknowledge the information provided on this claim for payment and attachments will be used by the Ministry of Agriculture and Food (the \"Ministry\") to assess the applicant's eligibility for funding from the Program;</li>\n          <li>understand that failing to comply with all application requirements may delay the processing of the application or make the applicant ineligible to receive funding under the Program;</li>\n          <li>represent that I have/the applicant has read and understood the Program Terms and Conditions and agree(s) to be bound by the Program Terms and Conditions;</li>\n          <li>represent that the applicant is in compliance with all Program eligibility requirements as described in the Program Terms and Conditions, and in this document;</li>\n          <li>agree to proactively disclose to the Program all other sources of funding the applicant or any partners within the same organization or the same farming or food processing operation receives with respect to the projects funded by this Program, including financial and/or in-kind contributions from federal, provincial, or municipal government;</li>\n          <li>understand that the Program covers costs up to the maximum Approved amount. Any additional fees over and above the approved amount are the responsibility of the applicant and will not be covered by the B.C. Ministry of Agriculture and Food.</li>\n          <li>acknowledge that the Business Number (GST Number) is collected by the Ministry under the authority of the Income Tax Act for the purpose of reporting income.</li>\n      </u>\n      <br/>\n  </div>";t=t.replace("%%ProgramName%%",e);var n=document.createElement("div");n.innerHTML=t,$("[data-name='applicantDeclarationSection']"),$("[data-name='applicantDeclarationSection']").parent().prepend(n)}(null==e?void 0:e.quartech_applicantportalprogramname)}(e)}}(e)}(e),hideLoadingAnimation())}})}var ne=Logger("powerpod");function powerpod(t){if(null==t||!t.form){var n=e.location.pathname;i.some((function(e){return n.includes(e)}))?(ne.info({message:"auto-detected ".concat(o.Claim," form")}),setOption("form",o.Claim)):r.some((function(e){return n.includes(e)}))?(ne.info({message:"auto-detected ".concat(o.Application," form")}),setOption("form",o.Application)):ne.error({message:"Unable to autodetect form type, path: ".concat(n)})}switch(function setOptions(e){C=deepExtend({},O,e),Object.assign({},C)}(t),ne.info({message:"setting up API with options:",data:getOptions()}),function setAPI(){m.getPowerpodData=function(){return{options:getOptions()}},m.version="0.6.0",e.powerpod=m}(),getOptions().form){case o.Application:ne.info({message:"initializing ".concat(o.Application)}),function initApplication(){hideFieldsAndSections(),getCurrentStep()===l.DemographicInfo?document.getElementById("ApplicationDemographicInfoStepQuickViewForm").addEventListener("load",(function(){var e;updatePageForSelectedProgram$1(null===(e=document.querySelector("#ApplicationDemographicInfoStepQuickViewForm"))||void 0===e||null===(e=e.contentWindow)||void 0===e||null===(e=e.document)||void 0===e||null===(e=e.querySelector("#quartech_program"))||void 0===e?void 0:e.value)})):updatePageForSelectedProgram$1(),function addNewAppSystemNotice$1(){var e=document.createElement("div");e.id="new_app_system_notice_div",e.style="float: left;",e.innerHTML='<br/><p>This is a new application system. Please bear with us as we work to improve the system. If you have any technical issues with the system or wish to provide feedback to help us to make it as user friendly as possible, please contact: <a href = "mailto: PODS@gov.bc.ca">PODS@gov.bc.ca</a></p>',$("#NextButton").parent().parent().parent().append(e)}(),function customizePageForFirefox(){var e=$("[data-name='applicantInfoTab_CodingSection']");e.length>0&&e.parent().css("display","none"),(e=$("[data-name='eligibilityTab_CodingSection']")).length>0&&e.parent().css("display","none"),(e=$("[data-name='projectTab_CodingSection']")).length>0&&e.parent().css("display","none"),(e=$("[data-name='tab_Deliverables_Budget_section_Coding']")).length>0&&e.parent().css("display","none"),(e=$("[data-name='documentsTab_CodingSection']")).length>0&&e.parent().css("display","none"),(e=$("[data-name='section_Coding']")).length>0&&e.parent().css("display","none"),(e=$("[data-name='tab_Declaration_Consent_section_Coding']")).length>0&&e.parent().css("display","none")}()}();break;case o.Claim:ne.info({message:"initializing ".concat(o.Claim)}),function initClaim(){hideFieldsAndSections(),updatePageForSelectedProgram(),function addNewAppSystemNotice(){var e,t=document.createElement("div");t.id="new_app_system_notice_div",t.style="float: left;";var n=null===(e=getClaimConfigData())||void 0===e?void 0:e.SystemNotice;t.innerHTML=n,$("#NextButton").parent().parent().parent().append(t)}()}();break;default:ne.error({message:"unable to init, no form type defined in options"})}return e.powerpod}var ae=Logger("jquery-adapter");function initJQueryAdapter(){return _initJQueryAdapter.apply(this,arguments)}function _initJQueryAdapter(){return _initJQueryAdapter=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(){var t,n;return _regeneratorRuntime().wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(ae.info({fn:initJQueryAdapter,message:"initializing jQuery adapter..."}),!e.jQuery){a.next=5;break}!function(e,n){if(!e||!n){var a="jQuery is required to use the jQuery powerpod!";return ae.error({fn:initJQueryAdapter,message:a}),Promise.reject(a)}e.fn.powerpod=function(t){t=e.extend({},t,{$:e}),ae.info({message:"$.fn.powerpod was called with options:",data:t}),n(t),ae.info({message:"creating the $.fn.powerpod object from POWERPOD:",data:m}),Object.keys(m).forEach((function(e){getOptions().$.fn.powerpod[e]=m[e]}))},t="successfully initialized jQuery adapter...",ae.info({fn:initJQueryAdapter,message:t})}(e.jQuery,powerpod),a.next=8;break;case 5:return n="jQuery is required to use the jQuery powerpod!",ae.error({fn:initJQueryAdapter,message:n}),a.abrupt("return",Promise.reject(n));case 8:return a.abrupt("return",Promise.resolve(t));case 9:case"end":return a.stop()}}),_callee)}))),_initJQueryAdapter.apply(this,arguments)}var ie=Logger("app");function autoinit(){ie.info({fn:autoinit,message:"starting autoinit, href: ".concat(e.location.href)});var t=e.location,a=t.host,i=t.pathname,r=n.DEV;if(getOptions().allowedEnvs.includes(r))if(getOptions().allowedHosts.includes(a))if(getOptions().allowedPaths.some((function(e){return i.includes(e)}))){var o={env:r,logging:!0};ie.info({fn:autoinit,message:"calling powerpod jQuery handler with options:",data:o}),$.fn.powerpod(o)}else ie.error({fn:autoinit,message:"current path is not in list of allowed paths, path: ".concat(i,", allowedPaths:"),data:getOptions().allowedPaths});else ie.error({fn:autoinit,message:"current host is not in list of allowed hosts, host: ".concat(a,", allowedHosts:"),data:getOptions().allowedHosts});else ie.error({fn:autoinit,message:"current environment is not in list of allowed environments, env: ".concat(r,", allowedEnvs:"),data:getOptions().allowedEnvs})}function start(){return _start.apply(this,arguments)}function _start(){return(_start=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(){var e;return _regeneratorRuntime().wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,ie.info({fn:start,message:"initializing jQuery adapter..."}),t.next=4,initJQueryAdapter();case 4:e=t.sent,ie.info({fn:start,message:e}),t.next=12;break;case 8:throw t.prev=8,t.t0=t.catch(0),ie.error({fn:start,message:t.t0}),new Error(t.t0);case 12:if(getOptions().autoinit){t.next=15;break}return ie.info({fn:start,message:"skipping autoinit, not configured in options"}),t.abrupt("return");case 15:autoinit();case 16:case"end":return t.stop()}}),_callee,null,[[0,8]])})))).apply(this,arguments)}return ie.info({message:"checking for jQuery..."}),e.jQuery?(ie.info({message:"jQuery found, running start..."}),start()):"complete"===t.readyState?(ie.info({message:"jQuery not found, but should be present at this point, running start..."}),start()):t.addEventListener?(ie.info({message:"jQuery not found, adding listener for document ready state..."}),t.addEventListener("readystatechange",(function(){switch(t.readyState){case"loading":ie.info({message:"document.readyState: "+t.readyState+"- The document is still loading."});break;case"interactive":ie.info({message:"document.readyState: "+t.readyState+'- The document has finished loading DOM. - "DOMContentLoaded" event'});break;case"complete":ie.info({message:"document.readyState: "+t.readyState+'- The page DOM with Sub-resources are now fully loaded. - "load" event'}),ie.info({message:"document load complete, running start..."}),start()}}))):e?(ie.info({message:"jQuery not found AND doc.addEventListener not found, adding listener for window loaded state..."}),e.addEventListener("load",(function(){start()}))):ie.error({message:"issue initializing app!"}),powerpod}));
